---
title: samlib.dll | SAM Library DLL
excerpt: What is samlib.dll?
---

# samlib.dll 

* File Path: `C:\Windows\SysWOW64\samlib.dll`
* Description: SAM Library DLL

## Hashes

Type | Hash
-- | --
MD5 | `0BDF6351009F6EBA5BA7E886F23263B1`
SHA1 | `3EA88E1819546E538E050266CDE6AA4CDB22B2ED`
SHA256 | `328B221FF7E37C6F58EF341CEE533167E499A7239450088180662DEF162D7302`
SHA384 | `80E341D31AEFC8B5641F8E0EC54E9E9350184844F7DA9D10F4A0A65CFE9AFB9EB2C5290F5626D1774278C62905039368`
SHA512 | `8A09E07427DF858B6D587D9E0B5F9CC605CBFCCAAECDBB2C0D4EE02A4E7746321F54DCB84B6642C7A622A14A76C2445374AD24E234C5FBA811221FD4F72A1986`
SSDEEP | `1536:T7bzVo2O9ij5TA+BMzkHMvA/uvcx9VzT:P3V5OwDA7cxfz`
IMP | `E6A213B654988D6519F1E7E49085E263`
PESHA1 | `A6E178DE3ACCF1C20889B0BAB3779972964B6548`
PE256 | `0F1085F695367C9E756FC8919F55AECB392E75F23DA268ADE81BFD1EF03F548D`

## DLL Exports:

Function Name | Ordinal | Type | Address | Relative Address
-- | -- | -- | -- | --
`OnMachineUILanguageInit` | 1 (0x1) | Exported Function | 0x4d189ec0 | 0x00009ec0
`SamLookupDomainInSamServer` | 29 (0x1d) | Exported Function | 0x4d184600 | 0x00004600
`SamLookupIdsInDomain` | 30 (0x1e) | Exported Function | 0x4d1858c0 | 0x000058c0
`SamLookupNamesInDomain` | 32 (0x20) | Exported Function | 0x4d1847e0 | 0x000047e0
`SamLookupNamesInDomain2` | 31 (0x1f) | Exported Function | 0x4d185d80 | 0x00005d80
`SamOpenAlias` | 33 (0x21) | Exported Function | 0x4d1857b0 | 0x000057b0
`SamOpenDomain` | 34 (0x22) | Exported Function | 0x4d1850c0 | 0x000050c0
`SamOpenGroup` | 35 (0x23) | Exported Function | 0x4d18c280 | 0x0000c280
`SamOpenUser` | 36 (0x24) | Exported Function | 0x4d184850 | 0x00004850
`SamPerformGenericOperation` | 37 (0x25) | Exported Function | 0x4d184000 | 0x00004000
`SamQueryDisplayInformation` | 38 (0x26) | Exported Function | 0x4d18c430 | 0x0000c430
`SamQueryInformationAlias` | 39 (0x27) | Exported Function | 0x4d18c680 | 0x0000c680
`SamQueryInformationDomain` | 40 (0x28) | Exported Function | 0x4d190b60 | 0x00010b60
`SamQueryInformationGroup` | 41 (0x29) | Exported Function | 0x4d18c7f0 | 0x0000c7f0
`SamQueryInformationUser` | 42 (0x2a) | Exported Function | 0x4d184d10 | 0x00004d10
`SamQueryLocalizableAccountsInDomain` | 43 (0x2b) | Exported Function | 0x4d18ca30 | 0x0000ca30
`SamQuerySecurityObject` | 44 (0x2c) | Exported Function | 0x4d184300 | 0x00004300
`SamRegisterObjectChangeNotification` | 45 (0x2d) | Exported Function | 0x4d183eb0 | 0x00003eb0
`SamTestPrivateFunctionsUser` | 59 (0x3b) | Exported Function | 0x4d18e140 | 0x0000e140
`SamTestPrivateFunctionsDomain` | 58 (0x3a) | Exported Function | 0x4d18e100 | 0x0000e100
`SamShutdownSamServer` | 57 (0x39) | Exported Function | 0x4d18e080 | 0x0000e080
`SamSetSecurityObject` | 56 (0x38) | Exported Function | 0x4d18de90 | 0x0000de90
`SamSetMemberAttributesOfGroup` | 55 (0x37) | Exported Function | 0x4d18dd10 | 0x0000dd10
`SamSetInformationUser` | 54 (0x36) | Exported Function | 0x4d18d5c0 | 0x0000d5c0
`SamiSyncDSRMPasswordFromAccount` | 70 (0x46) | Exported Function | 0x4d18f240 | 0x0000f240
`SamSetInformationGroup` | 53 (0x35) | Exported Function | 0x4d18d450 | 0x0000d450
`SamSetInformationAlias` | 51 (0x33) | Exported Function | 0x4d18d180 | 0x0000d180
`SamRidToSid` | 50 (0x32) | Exported Function | 0x4d184c40 | 0x00004c40
`SamRemoveMultipleMembersFromAlias` | 49 (0x31) | Exported Function | 0x4d18d000 | 0x0000d000
`SamRemoveMemberFromGroup` | 48 (0x30) | Exported Function | 0x4d18ce90 | 0x0000ce90
`SamRemoveMemberFromForeignDomain` | 47 (0x2f) | Exported Function | 0x4d18cd30 | 0x0000cd30
`SamRemoveMemberFromAlias` | 46 (0x2e) | Exported Function | 0x4d18cbd0 | 0x0000cbd0
`SamSetInformationDomain` | 52 (0x34) | Exported Function | 0x4d18d2f0 | 0x0000d2f0
`SamiSetDSRMPasswordOWF` | 69 (0x45) | Exported Function | 0x4d18f1f0 | 0x0000f1f0
`SamiSetDSRMPassword` | 68 (0x44) | Exported Function | 0x4d18f1a0 | 0x0000f1a0
`SamiSetBootKeyInformation` | 67 (0x43) | Exported Function | 0x4d18f030 | 0x0000f030
`SamDeleteGroup` | 15 (0xf) | Exported Function | 0x4d18b8f0 | 0x0000b8f0
`SamDeleteAlias` | 14 (0xe) | Exported Function | 0x4d18b780 | 0x0000b780
`SamCreateUserInDomain` | 13 (0xd) | Exported Function | 0x4d18b5d0 | 0x0000b5d0
`SamCreateUser2InDomain` | 12 (0xc) | Exported Function | 0x4d18b2c0 | 0x0000b2c0
`SamCreateGroupInDomain` | 11 (0xb) | Exported Function | 0x4d18b110 | 0x0000b110
`SamCreateAliasInDomain` | 10 (0xa) | Exported Function | 0x4d18af60 | 0x0000af60
`SamDeleteUser` | 16 (0x10) | Exported Function | 0x4d18ba60 | 0x0000ba60
`SamConnectWithCreds` | 9 (0x9) | Exported Function | 0x4d1909e0 | 0x000109e0
`SamCloseHandle` | 7 (0x7) | Exported Function | 0x4d185250 | 0x00005250
`SamChangePasswordUser2` | 5 (0x5) | Exported Function | 0x4d18aaf0 | 0x0000aaf0
`SamChangePasswordUser` | 6 (0x6) | Exported Function | 0x4d18acd0 | 0x0000acd0
`SamAddMultipleMembersToAlias` | 4 (0x4) | Exported Function | 0x4d18a970 | 0x0000a970
`SamAddMemberToGroup` | 3 (0x3) | Exported Function | 0x4d18a800 | 0x0000a800
`SamAddMemberToAlias` | 2 (0x2) | Exported Function | 0x4d185610 | 0x00005610
`SamConnect` | 8 (0x8) | Exported Function | 0x4d184de0 | 0x00004de0
`SamUnregisterObjectChangeNotification` | 60 (0x3c) | Exported Function | 0x4d183f60 | 0x00003f60
`SamEnumerateAliasesInDomain` | 17 (0x11) | Exported Function | 0x4d18bbd0 | 0x0000bbd0
`SamEnumerateGroupsInDomain` | 19 (0x13) | Exported Function | 0x4d18bd80 | 0x0000bd80
`SamiLmChangePasswordUser` | 66 (0x42) | Exported Function | 0x4d18eea0 | 0x0000eea0
`SamiEncryptPasswords` | 65 (0x41) | Exported Function | 0x4d189c10 | 0x00009c10
`SamiChangePasswordUser2` | 63 (0x3f) | Exported Function | 0x4d18e7b0 | 0x0000e7b0
`SamiChangePasswordUser` | 64 (0x40) | Exported Function | 0x4d18eb00 | 0x0000eb00
`SamiChangeKeys` | 62 (0x3e) | Exported Function | 0x4d18e390 | 0x0000e390
`SamGetMembersInGroup` | 28 (0x1c) | Exported Function | 0x4d18c0c0 | 0x0000c0c0
`SamEnumerateDomainsInSamServer` | 18 (0x12) | Exported Function | 0x4d1846d0 | 0x000046d0
`SamGetMembersInAlias` | 27 (0x1b) | Exported Function | 0x4d1856b0 | 0x000056b0
`SamGetDisplayEnumerationIndex` | 25 (0x19) | Exported Function | 0x4d18bf30 | 0x0000bf30
`SamGetCompatibilityMode` | 24 (0x18) | Exported Function | 0x4d1840e0 | 0x000040e0
`SamGetAliasMembership` | 23 (0x17) | Exported Function | 0x4d1844e0 | 0x000044e0
`SamFreeMemory` | 22 (0x16) | Exported Function | 0x4d183d20 | 0x00003d20
`SamEnumerateUsersInDomain2` | 20 (0x14) | Exported Function | 0x4d184080 | 0x00004080
`SamEnumerateUsersInDomain` | 21 (0x15) | Exported Function | 0x4d184150 | 0x00004150
`SamGetGroupsForUser` | 26 (0x1a) | Exported Function | 0x4d1843f0 | 0x000043f0
`SamValidatePassword` | 61 (0x3d) | Exported Function | 0x4d18e180 | 0x0000e180


## Signature

* Status: Signature verified.
* Serial: `3300000266BD1580EFA75CD6D3000000000266`
* Thumbprint: `A4341B9FD50FB9964283220A36A1EF6F6FAA7840`
* Issuer: CN=Microsoft Windows Production PCA 2011, O=Microsoft Corporation, L=Redmond, S=Washington, C=US
* Subject: CN=Microsoft Windows, O=Microsoft Corporation, L=Redmond, S=Washington, C=US

## File Metadata

* Original Filename: SAMLib.DLL
* Product Name: Microsoft Windows Operating System
* Company Name: Microsoft Corporation
* File Version: 10.0.19041.1 (WinBuild.160101.0800)
* Product Version: 10.0.19041.1
* Language: English (United States)
* Legal Copyright:  Microsoft Corporation. All rights reserved.
* Machine Type: 32-bit

## File Scan

* VirusTotal Detections: 0/71
* VirusTotal Link: https://www.virustotal.com/gui/file/328b221ff7e37c6f58ef341cee533167e499a7239450088180662def162d7302/detection/


## Possible Misuse

*The following table contains possible examples of `samlib.dll` being misused. While `samlib.dll` is **not** inherently malicious, its legitimate functionality can by abused for malicious purposes.*

Source | Source File | Example | License
-- | -- | -- | --
[sigma](https://github.com/Neo23x0/sigma) | [sysmon_mimikatz_inmemory_detection.yml](https://github.com/Neo23x0/sigma/blob/master/rules/windows/image_load/sysmon_mimikatz_inmemory_detection.yml) | `- 'samlib.dll'` | [DRL 1.0](https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md)
[sigma](https://github.com/Neo23x0/sigma) | [sysmon_susp_image_load.yml](https://github.com/Neo23x0/sigma/blob/master/rules/windows/image_load/sysmon_susp_image_load.yml) | `description: Detects Loading of samlib.dll, WinSCard.dll from untypical process e.g. through process hollowing by Mimikatz` | [DRL 1.0](https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md)
[sigma](https://github.com/Neo23x0/sigma) | [sysmon_susp_image_load.yml](https://github.com/Neo23x0/sigma/blob/master/rules/windows/image_load/sysmon_susp_image_load.yml) | `- '*\samlib.dll'` | [DRL 1.0](https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md)



MIT License. Copyright (c) 2020 Strontic.


