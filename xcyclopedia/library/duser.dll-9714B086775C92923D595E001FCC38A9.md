---
title: duser.dll | Windows DirectUser Engine
excerpt: What is duser.dll?
---

# duser.dll 

* File Path: `C:\Windows\SysWOW64\duser.dll`
* Description: Windows DirectUser Engine

## Hashes

Type | Hash
-- | --
MD5 | `9714B086775C92923D595E001FCC38A9`
SHA1 | `F10DC5007877101AF1A9B7A09037BB73F8F17CF9`
SHA256 | `21FCFC15A6FAF8A5C6D9448BBA70FB1B12C450C8A55DC9DE1EBA446B6E03E8CC`
SHA384 | `D68539ACBEAAC73130140E087BC9D9B2FDA73EE47F7A0C930B4C968F380AA7F2D15DFB777FBB0D2C3A7019E7A2555732`
SHA512 | `1D55B0FBDD667DF8580BD64682888FB93E75B4153F0EF0717431AB6F5793C75D47E26210E5AAAA412AB23996BDB00F1E386FDDFD41F45273521E94078E6269D2`
SSDEEP | `6144:Q+6aw7D0mOVDGH7eHZWyNhAbfVKYW5Jv8Ue8AyorwOAYphV+OU1HJYQU9SeP7pep:aaNVMX6Ezw4XOZYSe0LFfcTkiF/W`
IMP | `BE93A1386B6EFF3079BCBEAA9DAF19EA`
PESHA1 | `76EE2F7B836D87280C61EF958B6948797BE5BC5A`
PE256 | `86D2F3B46DED4CEB8500CFFA93736399B1E9F78A62852F9EB7B19CC860939DDA`

## DLL Exports:

Function Name | Ordinal | Type | Address | Relative Address
-- | -- | -- | -- | --
`AddGadgetMessageHandler` | 7 (0x7) | Exported Function | 0x10031d40 | 0x00031d40
`InitGadgets` | 98 (0x62) | Exported Function | 0x1000b6f0 | 0x0000b6f0
`InvalidateGadget` | 99 (0x63) | Exported Function | 0x10012340 | 0x00012340
`InvalidateLayeredDescendants` | 100 (0x64) | Exported Function | 0x10012b90 | 0x00012b90
`IsGadgetParentChainStyle` | 101 (0x65) | Exported Function | 0x10033c20 | 0x00033c20
`IsInsideContext` | 102 (0x66) | Exported Function | 0x10033d10 | 0x00033d10
`IsStartDelete` | 103 (0x67) | Exported Function | 0x10033d60 | 0x00033d60
`InitGadgetComponent` | 97 (0x61) | Exported Function | 0x10033b60 | 0x00033b60
`LookupGadgetTicket` | 104 (0x68) | Exported Function | 0x10033e40 | 0x00033e40
`PeekMessageExA` | 106 (0x6a) | Exported Function | 0x10033ff0 | 0x00033ff0
`PeekMessageExW` | 107 (0x6b) | Exported Function | 0x10034060 | 0x00034060
`RegisterGadgetMessage` | 108 (0x6c) | Exported Function | 0x1000cd60 | 0x0000cd60
`RegisterGadgetMessageString` | 109 (0x6d) | Exported Function | 0x100340d0 | 0x000340d0
`RegisterGadgetProperty` | 110 (0x6e) | Exported Function | 0x1000cde0 | 0x0000cde0
`ReleaseDetachedObjects` | 111 (0x6f) | Exported Function | 0x1001ebe0 | 0x0001ebe0
`MapGadgetPoints` | 105 (0x69) | Exported Function | 0x10033ee0 | 0x00033ee0
`GetStdPalette` | 96 (0x60) | Exported Function | 0x10033b50 | 0x00033b50
`GetStdColorPenI` | 95 (0x5f) | Exported Function | 0x10033aa0 | 0x00033aa0
`GetStdColorPenF` | 5 (0x5) | Exported Function | 0x10031b40 | 0x00031b40
`GetGadgetRgn` | 82 (0x52) | Exported Function | 0x10007d50 | 0x00007d50
`GetGadgetRootInfo` | 83 (0x53) | Exported Function | 0x10033500 | 0x00033500
`GetGadgetRotation` | 84 (0x54) | Exported Function | 0x100335e0 | 0x000335e0
`GetGadgetScale` | 85 (0x55) | Exported Function | 0x100336b0 | 0x000336b0
`GetGadgetSize` | 86 (0x56) | Exported Function | 0x10033780 | 0x00033780
`GetGadgetStyle` | 87 (0x57) | Exported Function | 0x10033860 | 0x00033860
`GetGadgetTicket` | 88 (0x58) | Exported Function | 0x100098d0 | 0x000098d0
`GetGadgetVisual` | 89 (0x59) | Exported Function | 0x1001eba0 | 0x0001eba0
`GetMessageExA` | 90 (0x5a) | Exported Function | 0x1000b8e0 | 0x0000b8e0
`GetMessageExW` | 91 (0x5b) | Exported Function | 0x10033920 | 0x00033920
`GetStdColorBrushF` | 3 (0x3) | Exported Function | 0x10031a30 | 0x00031a30
`GetStdColorBrushI` | 92 (0x5c) | Exported Function | 0x10033970 | 0x00033970
`GetStdColorF` | 4 (0x4) | Exported Function | 0x10031ae0 | 0x00031ae0
`GetStdColorI` | 93 (0x5d) | Exported Function | 0x10033a20 | 0x00033a20
`GetStdColorName` | 94 (0x5e) | Exported Function | 0x10033a60 | 0x00033a60
`ReleaseLayeredRef` | 112 (0x70) | Exported Function | 0x10034100 | 0x00034100
`ReleaseMouseCapture` | 113 (0x71) | Exported Function | 0x100341d0 | 0x000341d0
`RemoveClippingImmunityFromVisual` | 114 (0x72) | Exported Function | 0x1001ec20 | 0x0001ec20
`RemoveGadgetMessageHandler` | 115 (0x73) | Exported Function | 0x100342b0 | 0x000342b0
`SetGadgetRotation` | 135 (0x87) | Exported Function | 0x100351f0 | 0x000351f0
`SetGadgetScale` | 136 (0x88) | Exported Function | 0x10035320 | 0x00035320
`SetGadgetStyle` | 137 (0x89) | Exported Function | 0x10010290 | 0x00010290
`SetHardwareDeviceUsage` | 138 (0x8a) | Exported Function | 0x100118d0 | 0x000118d0
`SetMinimumDCompVersion` | 139 (0x8b) | Exported Function | 0x1001ecb0 | 0x0001ecb0
`SetRestoreCachedLayeredRefFlag` | 140 (0x8c) | Exported Function | 0x10035450 | 0x00035450
`SetTransitionVisualProperties` | 141 (0x8d) | Exported Function | 0x1001ecf0 | 0x0001ecf0
`SetWindowResizeFlag` | 142 (0x8e) | Exported Function | 0x10035510 | 0x00035510
`UnregisterGadgetMessage` | 143 (0x8f) | Exported Function | 0x100355d0 | 0x000355d0
`UnregisterGadgetMessageString` | 144 (0x90) | Exported Function | 0x100340d0 | 0x000340d0
`UnregisterGadgetProperty` | 145 (0x91) | Exported Function | 0x10035600 | 0x00035600
`UtilBuildFont` | 146 (0x92) | Exported Function | 0x10035630 | 0x00035630
`UtilDrawBlendRect` | 147 (0x93) | Exported Function | 0x10035650 | 0x00035650
`UtilDrawOutlineRect` | 6 (0x6) | Exported Function | 0x10031d20 | 0x00031d20
`UtilGetColor` | 148 (0x94) | Exported Function | 0x10035680 | 0x00035680
`SetGadgetRootInfo` | 134 (0x86) | Exported Function | 0x10011960 | 0x00011960
`GetGadgetRect` | 81 (0x51) | Exported Function | 0x1000a3d0 | 0x0000a3d0
`SetGadgetRect` | 133 (0x85) | Exported Function | 0x10008290 | 0x00008290
`SetGadgetParent` | 131 (0x83) | Exported Function | 0x10008560 | 0x00008560
`RemoveGadgetProperty` | 116 (0x74) | Exported Function | 0x100343f0 | 0x000343f0
`ResetDUserDevice` | 117 (0x75) | Exported Function | 0x10034510 | 0x00034510
`ScheduleGadgetTransitions` | 118 (0x76) | Exported Function | 0x1001ec60 | 0x0001ec60
`SetActionTimeslice` | 119 (0x77) | Exported Function | 0x10034600 | 0x00034600
`SetAtlasingHints` | 120 (0x78) | Exported Function | 0x100346b0 | 0x000346b0
`SetGadgetBufferInfo` | 121 (0x79) | Exported Function | 0x10034780 | 0x00034780
`SetGadgetCenterPoint` | 122 (0x7a) | Exported Function | 0x10034890 | 0x00034890
`SetGadgetFillF` | 123 (0x7b) | Exported Function | 0x100349c0 | 0x000349c0
`SetGadgetFillI` | 124 (0x7c) | Exported Function | 0x10034ae0 | 0x00034ae0
`SetGadgetFlags` | 125 (0x7d) | Exported Function | 0x10034c10 | 0x00034c10
`SetGadgetFocus` | 126 (0x7e) | Exported Function | 0x1000ad30 | 0x0000ad30
`SetGadgetFocusEx` | 127 (0x7f) | Exported Function | 0x10034d50 | 0x00034d50
`SetGadgetLayerInfo` | 128 (0x80) | Exported Function | 0x10034e70 | 0x00034e70
`SetGadgetMessageFilter` | 129 (0x81) | Exported Function | 0x10013590 | 0x00013590
`SetGadgetOrder` | 130 (0x82) | Exported Function | 0x10034f60 | 0x00034f60
`SetGadgetProperty` | 132 (0x84) | Exported Function | 0x100350c0 | 0x000350c0
`GetGadgetProperty` | 80 (0x50) | Exported Function | 0x10033420 | 0x00033420
`GetGadgetMessageFilter` | 79 (0x4f) | Exported Function | 0x10033360 | 0x00033360
`GetGadgetLayerInfo` | 78 (0x4e) | Exported Function | 0x10033270 | 0x00033270
`DetachGadgetVisuals` | 48 (0x30) | Exported Function | 0x1001e9a0 | 0x0001e9a0
`DetachWndProc` | 49 (0x31) | Exported Function | 0x10032590 | 0x00032590
`DisableContainerHwnd` | 50 (0x32) | Exported Function | 0x1000b660 | 0x0000b660
`DllMain` | 51 (0x33) | Exported Function | 0x100158c0 | 0x000158c0
`DrawGadgetTree` | 52 (0x34) | Exported Function | 0x100325c0 | 0x000325c0
`DUserBuildGadget` | 25 (0x19) | Exported Function | 0x10032210 | 0x00032210
`DUserCastClass` | 26 (0x1a) | Exported Function | 0x10032250 | 0x00032250
`DUserCastDirect` | 27 (0x1b) | Exported Function | 0x100322a0 | 0x000322a0
`DUserCastHandle` | 1 (0x1) | Exported Function | 0x10031670 | 0x00031670
`DUserDeleteGadget` | 2 (0x2) | Exported Function | 0x10031690 | 0x00031690
`DUserFindClass` | 28 (0x1c) | Exported Function | 0x100322e0 | 0x000322e0
`DUserFlushDeferredMessages` | 29 (0x1d) | Exported Function | 0x10014130 | 0x00014130
`DUserFlushMessages` | 30 (0x1e) | Exported Function | 0x1000b560 | 0x0000b560
`DUserGetAlphaPRID` | 31 (0x1f) | Exported Function | 0x1001f860 | 0x0001f860
`DUserGetGutsData` | 32 (0x20) | Exported Function | 0x10032340 | 0x00032340
`DestroyPendingDCVisuals` | 47 (0x2f) | Exported Function | 0x1001e980 | 0x0001e980
`DUserGetRectPRID` | 33 (0x21) | Exported Function | 0x1001f870 | 0x0001f870
`DeleteHandle` | 46 (0x2e) | Exported Function | 0x10012dc0 | 0x00012dc0
`CreateGadget` | 23 (0x17) | Exported Function | 0x1000f4b0 | 0x0000f4b0
`AddLayeredRef` | 8 (0x8) | Exported Function | 0x10031e80 | 0x00031e80
`AdjustClipInsideRef` | 9 (0x9) | Exported Function | 0x10031f50 | 0x00031f50
`AttachWndProcA` | 10 (0xa) | Exported Function | 0x10032020 | 0x00032020
`AttachWndProcW` | 11 (0xb) | Exported Function | 0x1000a500 | 0x0000a500
`AutoTrace` | 12 (0xc) | Exported Function | 0x10016a80 | 0x00016a80
`BeginHideInputPaneAnimation` | 13 (0xd) | Exported Function | 0x1001e670 | 0x0001e670
`BeginShowInputPaneAnimation` | 14 (0xe) | Exported Function | 0x1001e6a0 | 0x0001e6a0
`BuildAnimation` | 15 (0xf) | Exported Function | 0x1001e6d0 | 0x0001e6d0
`BuildDropTarget` | 16 (0x10) | Exported Function | 0x1001e760 | 0x0001e760
`BuildInterpolation` | 17 (0x11) | Exported Function | 0x1001e7c0 | 0x0001e7c0
`CacheDWriteRenderTarget` | 18 (0x12) | Exported Function | 0x1001e850 | 0x0001e850
`ChangeCurrentAnimationScenario` | 19 (0x13) | Exported Function | 0x1001e890 | 0x0001e890
`ClearPushedOpacitiesFromGadgetTree` | 20 (0x14) | Exported Function | 0x10032050 | 0x00032050
`ClearTopmostVisual` | 21 (0x15) | Exported Function | 0x1001e8d0 | 0x0001e8d0
`CreateAction` | 22 (0x16) | Exported Function | 0x10032150 | 0x00032150
`CustomGadgetHitTestQuery` | 24 (0x18) | Exported Function | 0x1001e900 | 0x0001e900
`UtilSetBackground` | 149 (0x95) | Exported Function | 0x100356a0 | 0x000356a0
`DUserGetRotatePRID` | 34 (0x22) | Exported Function | 0x1001f880 | 0x0001f880
`DUserInstanceOf` | 36 (0x24) | Exported Function | 0x10032390 | 0x00032390
`FreeGdiDxInteropStagingBuffer` | 63 (0x3f) | Exported Function | 0x10032c80 | 0x00032c80
`GadgetTransCompositionChanged` | 64 (0x40) | Exported Function | 0x10032d40 | 0x00032d40
`GadgetTransSettingChanged` | 65 (0x41) | Exported Function | 0x10014b10 | 0x00014b10
`GetActionTimeslice` | 66 (0x42) | Exported Function | 0x10032e10 | 0x00032e10
`GetCachedDWriteRenderTarget` | 67 (0x43) | Exported Function | 0x1001ea80 | 0x0001ea80
`GetDebug` | 69 (0x45) | Exported Function | 0x10016aa0 | 0x00016aa0
`GetDUserModule` | 68 (0x44) | Exported Function | 0x10032ec0 | 0x00032ec0
`GetFinalAnimatingPosition` | 70 (0x46) | Exported Function | 0x1001ead0 | 0x0001ead0
`GetGadget` | 71 (0x47) | Exported Function | 0x10032ed0 | 0x00032ed0
`GetGadgetAnimation` | 72 (0x48) | Exported Function | 0x1001eb20 | 0x0001eb20
`GetGadgetBitmap` | 73 (0x49) | Exported Function | 0x10032fa0 | 0x00032fa0
`GetGadgetBufferInfo` | 74 (0x4a) | Exported Function | 0x100330b0 | 0x000330b0
`GetGadgetCenterPoint` | 75 (0x4b) | Exported Function | 0x100331a0 | 0x000331a0
`GetGadgetFlags` | 76 (0x4c) | Exported Function | 0x1000a160 | 0x0000a160
`GetGadgetFocus` | 77 (0x4d) | Exported Function | 0x1000c3b0 | 0x0000c3b0
`ForwardGadgetMessage` | 62 (0x3e) | Exported Function | 0x10032b50 | 0x00032b50
`DUserGetScalePRID` | 35 (0x23) | Exported Function | 0x1001f890 | 0x0001f890
`FireGadgetMessages` | 61 (0x3d) | Exported Function | 0x10032a80 | 0x00032a80
`FindGadgetTargetingInfo` | 59 (0x3b) | Exported Function | 0x100329b0 | 0x000329b0
`DUserPostEvent` | 37 (0x25) | Exported Function | 0x100323e0 | 0x000323e0
`DUserPostMethod` | 38 (0x26) | Exported Function | 0x10032470 | 0x00032470
`DUserRegisterGuts` | 39 (0x27) | Exported Function | 0x1000efc0 | 0x0000efc0
`DUserRegisterStub` | 40 (0x28) | Exported Function | 0x1000f260 | 0x0000f260
`DUserRegisterSuper` | 41 (0x29) | Exported Function | 0x1000eee0 | 0x0000eee0
`DUserSendEvent` | 42 (0x2a) | Exported Function | 0x1000e770 | 0x0000e770
`DUserSendMethod` | 43 (0x2b) | Exported Function | 0x10032500 | 0x00032500
`DUserStopAnimation` | 44 (0x2c) | Exported Function | 0x1001fd30 | 0x0001fd30
`DUserStopPVLAnimation` | 45 (0x2d) | Exported Function | 0x1001e940 | 0x0001e940
`EndInputPaneAnimation` | 53 (0x35) | Exported Function | 0x1001e9f0 | 0x0001e9f0
`EnsureAnimationsEnabled` | 54 (0x36) | Exported Function | 0x1001ea20 | 0x0001ea20
`EnsureGadgetTransInitialized` | 55 (0x37) | Exported Function | 0x1001ea50 | 0x0001ea50
`EnumGadgets` | 56 (0x38) | Exported Function | 0x100326c0 | 0x000326c0
`FindGadgetFromPoint` | 57 (0x39) | Exported Function | 0x10032800 | 0x00032800
`FindGadgetMessages` | 58 (0x3a) | Exported Function | 0x100328f0 | 0x000328f0
`FindStdColor` | 60 (0x3c) | Exported Function | 0x1000a310 | 0x0000a310
`WaitMessageEx` | 150 (0x96) | Exported Function | 0x100356f0 | 0x000356f0


## Signature

* Status: Signature verified.
* Serial: `3300000266BD1580EFA75CD6D3000000000266`
* Thumbprint: `A4341B9FD50FB9964283220A36A1EF6F6FAA7840`
* Issuer: CN=Microsoft Windows Production PCA 2011, O=Microsoft Corporation, L=Redmond, S=Washington, C=US
* Subject: CN=Microsoft Windows, O=Microsoft Corporation, L=Redmond, S=Washington, C=US

## File Metadata

* Original Filename: DUser.DLL
* Product Name: Microsoft Windows Operating System
* Company Name: Microsoft Corporation
* File Version: 10.0.19041.1 (WinBuild.160101.0800)
* Product Version: 10.0.19041.1
* Language: English (United States)
* Legal Copyright:  Microsoft Corporation. All rights reserved.
* Machine Type: 32-bit

## File Scan

* VirusTotal Detections: 0/67
* VirusTotal Link: https://www.virustotal.com/gui/file/21fcfc15a6faf8a5c6d9448bba70fb1b12c450c8a55dc9de1eba446b6e03e8cc/detection/


## Possible Misuse

*The following table contains possible examples of `duser.dll` being misused. While `duser.dll` is **not** inherently malicious, its legitimate functionality can by abused for malicious purposes.*

Source | Source File | Example | License
-- | -- | -- | --
[signature-base](https://github.com/Neo23x0/signature-base) | [apt_sidewinder.yar](https://github.com/Neo23x0/signature-base/blob/master/yara/apt_sidewinder.yar) | $a1 = "DUSER.dll" fullword wide | [CC BY-NC 4.0](https://github.com/Neo23x0/signature-base/blob/master/LICENSE)



MIT License. Copyright (c) 2020 Strontic.


