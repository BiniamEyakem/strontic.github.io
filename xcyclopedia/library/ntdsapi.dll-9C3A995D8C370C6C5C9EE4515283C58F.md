---
title: ntdsapi.dll | Active Directory Domain Services API
excerpt: What is ntdsapi.dll?
---

# ntdsapi.dll 

* File Path: `C:\Windows\SysWOW64\ntdsapi.dll`
* Description: Active Directory Domain Services API

## Hashes

Type | Hash
-- | --
MD5 | `9C3A995D8C370C6C5C9EE4515283C58F`
SHA1 | `5B31721978E0884D0DD714A7AF3A961CD5A3FD98`
SHA256 | `8A5265CC76C1E1595CAEA0E663ED6F1DCE9AA58F9530A7BCA6938769E8E13863`
SHA384 | `0B799E7C311485BC2375834B28E75D89A610715DC027CD93138B2F82E302F1EA35FA82A7039AABB817EE3CD94B494D9F`
SHA512 | `077E2746F37573AEED5FD648B23AC385EC897837F0B2574947D824BB184EBFF28A56B1EE6E5F074E2EFA7F7BB21E90D61DBE35760C574881D38690AB1ED08AC5`
SSDEEP | `1536:5qLTJfoS39O4xraJenrokab6NTCcfvjPkGqehQF7lzn5BElwvJPPPC57kG+hBBHs:5YTJfoS3o4xraJenrmaCYQUhQFFnPBPm`
IMP | `E56A0929B0F93F4FEB6212737B6C95CC`
PESHA1 | `BD19BB8958E45AE740944F0EDC0499B498BC9B73`
PE256 | `D1D58521009350DA00FA23EED5135E63D315A989012640C89D635D3ADB115000`

## DLL Exports:

Function Name | Ordinal | Type | Address | Relative Address
-- | -- | -- | -- | --
`DsAddCloneDCW` | 1 (0x1) | Exported Function | 0x59290af0 | 0x00010af0
`DsReadNgcKeyWWorker` | 90 (0x5a) | Exported Function | 0x59293230 | 0x00013230
`DsReadNgcKeyW` | 89 (0x59) | Exported Function | 0x59293190 | 0x00013190
`DsReadNgcKeyA` | 88 (0x58) | Exported Function | 0x592931d0 | 0x000131d0
`DsQuoteRdnValueW` | 87 (0x57) | Exported Function | DSPARSE.DsQuoteRdnValueW | 0x000155b3
`DsQuoteRdnValueA` | 86 (0x56) | Exported Function | DSPARSE.DsQuoteRdnValueA | 0x00015589
`DsQuerySitesFree` | 85 (0x55) | Exported Function | 0x59290c40 | 0x00010c40
`DsQuerySitesByCostW` | 84 (0x54) | Exported Function | 0x59292a00 | 0x00012a00
`DsQuerySitesByCostA` | 83 (0x53) | Exported Function | 0x592928a0 | 0x000128a0
`DsMapSchemaGuidsW` | 82 (0x52) | Exported Function | 0x59292480 | 0x00012480
`DsMapSchemaGuidsA` | 81 (0x51) | Exported Function | 0x592921f0 | 0x000121f0
`DsMakeSpnW` | 80 (0x50) | Exported Function | DSPARSE.DsMakeSpnW | 0x00015508
`DsMakeSpnA` | 79 (0x4f) | Exported Function | DSPARSE.DsMakeSpnA | 0x000154ea
`DsMakePasswordCredentialsWWorker` | 78 (0x4e) | Exported Function | 0x592852c0 | 0x000052c0
`DsMakePasswordCredentialsW` | 77 (0x4d) | Exported Function | 0x592855a0 | 0x000055a0
`DsMakePasswordCredentialsA` | 76 (0x4c) | Exported Function | 0x5928b0a0 | 0x0000b0a0
`DsLogEntry` | 75 (0x4b) | Exported Function | 0x59293060 | 0x00013060
`DsListSitesW` | 74 (0x4a) | Exported Function | 0x59292860 | 0x00012860
`DsListSitesA` | 73 (0x49) | Exported Function | 0x59292820 | 0x00012820
`DsListServersInSiteW` | 72 (0x48) | Exported Function | 0x592927f0 | 0x000127f0
`DsListServersInSiteA` | 71 (0x47) | Exported Function | 0x592927c0 | 0x000127c0
`DsListServersForDomainInSiteW` | 70 (0x46) | Exported Function | 0x59292760 | 0x00012760
`DsListServersForDomainInSiteA` | 69 (0x45) | Exported Function | 0x59292700 | 0x00012700
`DsListRolesW` | 68 (0x44) | Exported Function | 0x592926c0 | 0x000126c0
`DsListRolesA` | 67 (0x43) | Exported Function | 0x59292680 | 0x00012680
`DsListInfoForServerW` | 66 (0x42) | Exported Function | 0x59292650 | 0x00012650
`DsListInfoForServerA` | 65 (0x41) | Exported Function | 0x59292620 | 0x00012620
`DsListDomainsInSiteW` | 64 (0x40) | Exported Function | 0x592925d0 | 0x000125d0
`DsListDomainsInSiteA` | 63 (0x3f) | Exported Function | 0x59292590 | 0x00012590
`DsIsMangledRdnValueW` | 62 (0x3e) | Exported Function | DSPARSE.DsIsMangledRdnValueW | 0x00015372
`DsRemoveDsDomainA` | 91 (0x5b) | Exported Function | 0x592905e0 | 0x000105e0
`DsIsMangledRdnValueA` | 61 (0x3d) | Exported Function | DSPARSE.DsIsMangledRdnValueA | 0x00015340
`DsRemoveDsDomainW` | 92 (0x5c) | Exported Function | 0x59290690 | 0x00010690
`DsRemoveDsServerW` | 94 (0x5e) | Exported Function | 0x592908a0 | 0x000108a0
`DsWriteNgcKeyA` | 123 (0x7b) | Exported Function | 0x59293320 | 0x00013320
`DsWriteAccountSpnW` | 122 (0x7a) | Exported Function | 0x59287720 | 0x00007720
`DsWriteAccountSpnA` | 121 (0x79) | Exported Function | 0x59292ed0 | 0x00012ed0
`DsUnquoteRdnValueW` | 120 (0x78) | Exported Function | DSPARSE.DsUnquoteRdnValueW | 0x0001582d
`DsUnquoteRdnValueA` | 119 (0x77) | Exported Function | DSPARSE.DsUnquoteRdnValueA | 0x000157ff
`DsUnBindWWorker` | 118 (0x76) | Exported Function | 0x592860e0 | 0x000060e0
`DsUnBindW` | 117 (0x75) | Exported Function | 0x592855c0 | 0x000055c0
`DsUnBindA` | 116 (0x74) | Exported Function | 0x592855c0 | 0x000055c0
`DsServerRegisterSpnW` | 115 (0x73) | Exported Function | 0x59287530 | 0x00007530
`DsServerRegisterSpnA` | 114 (0x72) | Exported Function | 0x59292e50 | 0x00012e50
`DsReplicaVerifyObjectsW` | 113 (0x71) | Exported Function | 0x59292080 | 0x00012080
`DsReplicaVerifyObjectsA` | 112 (0x70) | Exported Function | 0x59292030 | 0x00012030
`DsReplicaUpdateRefsW` | 111 (0x6f) | Exported Function | 0x59291e80 | 0x00011e80
`DsReplicaUpdateRefsA` | 110 (0x6e) | Exported Function | 0x59291e00 | 0x00011e00
`DsReplicaSyncW` | 109 (0x6d) | Exported Function | 0x59291cb0 | 0x00011cb0
`DsReplicaSyncAllW` | 108 (0x6c) | Exported Function | 0x5928fe90 | 0x0000fe90
`DsReplicaSyncAllA` | 107 (0x6b) | Exported Function | 0x5928fa50 | 0x0000fa50
`DsReplicaSyncA` | 106 (0x6a) | Exported Function | 0x59291c60 | 0x00011c60
`DsReplicaModifyW` | 105 (0x69) | Exported Function | 0x59291910 | 0x00011910
`DsReplicaModifyA` | 104 (0x68) | Exported Function | 0x59291850 | 0x00011850
`DsReplicaGetInfoW` | 103 (0x67) | Exported Function | 0x59291820 | 0x00011820
`DsReplicaGetInfo2W` | 102 (0x66) | Exported Function | 0x592915d0 | 0x000115d0
`DsReplicaFreeInfo` | 101 (0x65) | Exported Function | 0x59291370 | 0x00011370
`DsReplicaDemotionW` | 100 (0x64) | Exported Function | 0x592909d0 | 0x000109d0
`DsReplicaDelW` | 99 (0x63) | Exported Function | 0x59291220 | 0x00011220
`DsReplicaDelA` | 98 (0x62) | Exported Function | 0x592911a0 | 0x000111a0
`DsReplicaConsistencyCheck` | 97 (0x61) | Exported Function | 0x592910e0 | 0x000110e0
`DsReplicaAddW` | 96 (0x60) | Exported Function | 0x59290d30 | 0x00010d30
`DsReplicaAddA` | 95 (0x5f) | Exported Function | 0x59290c60 | 0x00010c60
`DsRemoveDsServerA` | 93 (0x5d) | Exported Function | 0x592907a0 | 0x000107a0
`DsWriteNgcKeyW` | 124 (0x7c) | Exported Function | 0x592931b0 | 0x000131b0
`DsIsMangledDnW` | 60 (0x3c) | Exported Function | DSPARSE.DsIsMangledDnW | 0x00015314
`DsInitDemotionW` | 58 (0x3a) | Exported Function | 0x59290520 | 0x00010520
`DsCrackSpn2W` | 24 (0x18) | Exported Function | DSPARSE.DsCrackSpn2W | 0x00014f6c
`DsCrackSpn2A` | 23 (0x17) | Exported Function | DSPARSE.DsCrackSpn2A | 0x00014f4a
`DsCrackNamesWWorker` | 22 (0x16) | Exported Function | 0x59286250 | 0x00006250
`DsCrackNamesW` | 21 (0x15) | Exported Function | 0x59285540 | 0x00005540
`DsCrackNamesA` | 20 (0x14) | Exported Function | 0x5928baa0 | 0x0000baa0
`DsClientMakeSpnForTargetServerW` | 19 (0x13) | Exported Function | 0x59285ec0 | 0x00005ec0
`DsClientMakeSpnForTargetServerA` | 18 (0x12) | Exported Function | 0x59292b30 | 0x00012b30
`DsBindWithSpnW` | 16 (0x10) | Exported Function | 0x5928b070 | 0x0000b070
`DsBindWithSpnExWWorker` | 15 (0xf) | Exported Function | 0x592855f0 | 0x000055f0
`DsBindWithSpnExW` | 14 (0xe) | Exported Function | 0x59293020 | 0x00013020
`DsBindWithSpnExA` | 13 (0xd) | Exported Function | 0x5928b630 | 0x0000b630
`DsBindWithSpnA` | 12 (0xc) | Exported Function | 0x5928b040 | 0x0000b040
`DsBindWithCredW` | 11 (0xb) | Exported Function | 0x59285560 | 0x00005560
`DsBindWithCredA` | 10 (0xa) | Exported Function | 0x5928b010 | 0x0000b010
`DsBindW` | 9 (0x9) | Exported Function | 0x5928afe0 | 0x0000afe0
`DsBindToISTGW` | 8 (0x8) | Exported Function | 0x5928b350 | 0x0000b350
`DsBindToISTGA` | 7 (0x7) | Exported Function | 0x5928b2d0 | 0x0000b2d0
`DsBindingSetTimeout` | 17 (0x11) | Exported Function | 0x5928b720 | 0x0000b720
`DsBindByInstanceW` | 6 (0x6) | Exported Function | 0x59285620 | 0x00005620
`DsBindByInstanceA` | 5 (0x5) | Exported Function | 0x5928b1b0 | 0x0000b1b0
`DsBindA` | 4 (0x4) | Exported Function | 0x5928afb0 | 0x0000afb0
`DsaopUnBind` | 131 (0x83) | Exported Function | 0x59290380 | 0x00010380
`DsaopPrepareScript` | 130 (0x82) | Exported Function | 0x59290300 | 0x00010300
`DsaopExecuteScript` | 129 (0x81) | Exported Function | 0x59290270 | 0x00010270
`DsaopBindWithSpn` | 128 (0x80) | Exported Function | 0x5928fff0 | 0x0000fff0
`DsaopBindWithCred` | 127 (0x7f) | Exported Function | 0x5928ffc0 | 0x0000ffc0
`DsaopBind` | 126 (0x7e) | Exported Function | 0x5928ff90 | 0x0000ff90
`DsAddSidHistoryW` | 3 (0x3) | Exported Function | 0x5928a8e0 | 0x0000a8e0
`DsAddSidHistoryA` | 2 (0x2) | Exported Function | 0x5928a760 | 0x0000a760
`DsCrackSpn3W` | 25 (0x19) | Exported Function | DSPARSE.DsCrackSpn3W | 0x00014f8e
`DsIsMangledDnA` | 59 (0x3b) | Exported Function | DSPARSE.DsIsMangledDnA | 0x000152ee
`DsCrackSpn4W` | 26 (0x1a) | Exported Function | DSPARSE.DsCrackSpn4W | 0x00014fb0
`DsCrackSpnW` | 28 (0x1c) | Exported Function | DSPARSE.DsCrackSpnW | 0x00014ff1
`DsInheritSecurityIdentityW` | 57 (0x39) | Exported Function | 0x5928ae30 | 0x0000ae30
`DsInheritSecurityIdentityA` | 56 (0x38) | Exported Function | 0x5928ad90 | 0x0000ad90
`DsGetSpnW` | 55 (0x37) | Exported Function | 0x59287820 | 0x00007820
`DsGetSpnA` | 54 (0x36) | Exported Function | 0x59292c50 | 0x00012c50
`DsGetRdnW` | 53 (0x35) | Exported Function | DSPARSE.DsGetRdnW | 0x00015273
`DsGetDomainControllerInfoWWorker` | 52 (0x34) | Exported Function | 0x5928c660 | 0x0000c660
`DsGetDomainControllerInfoW` | 51 (0x33) | Exported Function | 0x59293040 | 0x00013040
`DsGetDomainControllerInfoA` | 50 (0x32) | Exported Function | 0x5928c3f0 | 0x0000c3f0
`DsGetBindInstGuid` | 49 (0x31) | Exported Function | 0x5928b7d0 | 0x0000b7d0
`DsGetBindAnnotW` | 48 (0x30) | Exported Function | 0x5928b7a0 | 0x0000b7a0
`DsGetBindAddrW` | 47 (0x2f) | Exported Function | 0x5928b770 | 0x0000b770
`DsFreeSpnArrayW` | 46 (0x2e) | Exported Function | 0x592876e0 | 0x000076e0
`DsFreeSpnArrayA` | 45 (0x2d) | Exported Function | 0x59292c40 | 0x00012c40
`DsFreeSchemaGuidMapW` | 44 (0x2c) | Exported Function | 0x592921c0 | 0x000121c0
`DsFreeSchemaGuidMapA` | 43 (0x2b) | Exported Function | 0x592921b0 | 0x000121b0
`DsFreePasswordCredentialsWorker` | 42 (0x2a) | Exported Function | 0x592854b0 | 0x000054b0
`DsFreePasswordCredentials` | 41 (0x29) | Exported Function | 0x592855e0 | 0x000055e0
`DsFreeNgcKeyWorker` | 40 (0x28) | Exported Function | 0x592903e0 | 0x000103e0
`DsFreeNgcKey` | 39 (0x27) | Exported Function | 0x59293180 | 0x00013180
`DsFreeNameResultWWorker` | 38 (0x26) | Exported Function | 0x59286020 | 0x00006020
`DsFreeNameResultW` | 37 (0x25) | Exported Function | 0x59285590 | 0x00005590
`DsFreeNameResultA` | 36 (0x24) | Exported Function | 0x59285590 | 0x00005590
`DsFreeDomainControllerInfoWWorker` | 35 (0x23) | Exported Function | 0x5928c280 | 0x0000c280
`DsFreeDomainControllerInfoW` | 34 (0x22) | Exported Function | 0x5928c270 | 0x0000c270
`DsFreeDomainControllerInfoA` | 33 (0x21) | Exported Function | 0x5928c270 | 0x0000c270
`DsFreeCloneDcResult` | 32 (0x20) | Exported Function | 0x59290c40 | 0x00010c40
`DsFinishDemotionW` | 31 (0x1f) | Exported Function | 0x59290400 | 0x00010400
`DsCrackUnquotedMangledRdnW` | 30 (0x1e) | Exported Function | DSPARSE.DsCrackUnquotedMangledRdnW | 0x0001505e
`DsCrackUnquotedMangledRdnA` | 29 (0x1d) | Exported Function | DSPARSE.DsCrackUnquotedMangledRdnA | 0x00015020
`DsCrackSpnA` | 27 (0x1b) | Exported Function | DSPARSE.DsCrackSpnA | 0x00014fd1
`DsWriteNgcKeyWWorker` | 125 (0x7d) | Exported Function | 0x59293380 | 0x00013380


## Signature

* Status: Signature verified.
* Serial: `3300000266BD1580EFA75CD6D3000000000266`
* Thumbprint: `A4341B9FD50FB9964283220A36A1EF6F6FAA7840`
* Issuer: CN=Microsoft Windows Production PCA 2011, O=Microsoft Corporation, L=Redmond, S=Washington, C=US
* Subject: CN=Microsoft Windows, O=Microsoft Corporation, L=Redmond, S=Washington, C=US

## File Metadata

* Original Filename: ntdsapi.dll
* Product Name: Microsoft Windows Operating System
* Company Name: Microsoft Corporation
* File Version: 10.0.19041.1 (WinBuild.160101.0800)
* Product Version: 10.0.19041.1
* Language: English (United States)
* Legal Copyright:  Microsoft Corporation. All rights reserved.
* Machine Type: 32-bit

## File Scan

* VirusTotal Detections: 0/71
* VirusTotal Link: https://www.virustotal.com/gui/file/8a5265cc76c1e1595caea0e663ed6f1dce9aa58f9530a7bca6938769e8e13863/detection/

## File Similarity (ssdeep match)

File | Score
-- | --
[C:\Windows\SysWOW64\dsmgmt.exe](dsmgmt.exe-6222DD5B0F8120806673AB634E5844FB.md) | 41

## Possible Misuse

*The following table contains possible examples of `ntdsapi.dll` being misused. While `ntdsapi.dll` is **not** inherently malicious, its legitimate functionality can by abused for malicious purposes.*

Source | Source File | Example | License
-- | -- | -- | --
[sigma](https://github.com/Neo23x0/sigma) | [sysmon_mimikatz_inmemory_detection.yml](https://github.com/Neo23x0/sigma/blob/master/rules/windows/image_load/sysmon_mimikatz_inmemory_detection.yml) | `- 'ntdsapi.dll'` | [DRL 1.0](https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md)



MIT License. Copyright (c) 2020 Strontic.


