---
title: ntdsapi.dll | Active Directory Domain Services API
excerpt: What is ntdsapi.dll?
---

# ntdsapi.dll 

* File Path: `C:\Windows\system32\ntdsapi.dll`
* Description: Active Directory Domain Services API

## Hashes

Type | Hash
-- | --
MD5 | `BC568753179FE7812FE36638457C6F3E`
SHA1 | `A8D2BC2C795FDCF42796260E9727762446BFBBB9`
SHA256 | `3C24C9EEB2BB4CA8B870910BE6EA77891099E26DD12A8B07D0204E6277610974`
SHA384 | `26B609AD554BF5B02FEAE56AB463B3C6E11315D8EAAFF14105F140CEB8850F17E49D563001763AE92EC96FF23EAD08EA`
SHA512 | `6DFC70057C22C474ABB2A0385D4D0941FF56534399EA938FF858ACA7C69862D3BD27D2CFE0174455293D466E42AC50DFB6BE179F6B020827004C9E661EDF2EB7`
SSDEEP | `3072:C1zntk1MHQ2VVMIVLKXz6+YaFH8NwZaWc52oJe8jOkt8CO:CdtkWTV/2OraFH8NwZaWc52os6Okt8`
IMP | `964A9AB9A13527FC9BFA5A7D1D1103B8`
PESHA1 | `8570A8C4720A48E268FC9E4997677A6FB81ECA5F`
PE256 | `C560461EE577704615370B29C4153CE1352EFE738EAFB8854BEA4B63229D506D`

## DLL Exports:

Function Name | Ordinal | Type | Address | Relative Address
-- | -- | -- | -- | --
`DsAddCloneDCW` | 1 (0x1) | Exported Function | 0x000000018000fdd0 | 0x0000fdd0
`DsReadNgcKeyWWorker` | 90 (0x5a) | Exported Function | 0x0000000180013310 | 0x00013310
`DsReadNgcKeyW` | 89 (0x59) | Exported Function | 0x0000000180013230 | 0x00013230
`DsReadNgcKeyA` | 88 (0x58) | Exported Function | 0x0000000180013270 | 0x00013270
`DsQuoteRdnValueW` | 87 (0x57) | Exported Function | DSPARSE.DsQuoteRdnValueW | 0x000234f3
`DsQuoteRdnValueA` | 86 (0x56) | Exported Function | DSPARSE.DsQuoteRdnValueA | 0x000234c9
`DsQuerySitesFree` | 85 (0x55) | Exported Function | 0x000000018000ff80 | 0x0000ff80
`DsQuerySitesByCostW` | 84 (0x54) | Exported Function | 0x0000000180012440 | 0x00012440
`DsQuerySitesByCostA` | 83 (0x53) | Exported Function | 0x0000000180012280 | 0x00012280
`DsMapSchemaGuidsW` | 82 (0x52) | Exported Function | 0x0000000180011d30 | 0x00011d30
`DsMapSchemaGuidsA` | 81 (0x51) | Exported Function | 0x00000001800119d0 | 0x000119d0
`DsMakeSpnW` | 80 (0x50) | Exported Function | DSPARSE.DsMakeSpnW | 0x00023448
`DsMakeSpnA` | 79 (0x4f) | Exported Function | DSPARSE.DsMakeSpnA | 0x0002342a
`DsMakePasswordCredentialsWWorker` | 78 (0x4e) | Exported Function | 0x0000000180001010 | 0x00001010
`DsMakePasswordCredentialsW` | 77 (0x4d) | Exported Function | 0x0000000180001380 | 0x00001380
`DsMakePasswordCredentialsA` | 76 (0x4c) | Exported Function | 0x0000000180007e70 | 0x00007e70
`DsLogEntry` | 75 (0x4b) | Exported Function | 0x00000001800130b0 | 0x000130b0
`DsListSitesW` | 74 (0x4a) | Exported Function | 0x0000000180012230 | 0x00012230
`DsListSitesA` | 73 (0x49) | Exported Function | 0x00000001800121e0 | 0x000121e0
`DsListServersInSiteW` | 72 (0x48) | Exported Function | 0x0000000180012190 | 0x00012190
`DsListServersInSiteA` | 71 (0x47) | Exported Function | 0x0000000180012150 | 0x00012150
`DsListServersForDomainInSiteW` | 70 (0x46) | Exported Function | 0x00000001800120e0 | 0x000120e0
`DsListServersForDomainInSiteA` | 69 (0x45) | Exported Function | 0x0000000180012070 | 0x00012070
`DsListRolesW` | 68 (0x44) | Exported Function | 0x0000000180012020 | 0x00012020
`DsListRolesA` | 67 (0x43) | Exported Function | 0x0000000180011fd0 | 0x00011fd0
`DsListInfoForServerW` | 66 (0x42) | Exported Function | 0x0000000180011f80 | 0x00011f80
`DsListInfoForServerA` | 65 (0x41) | Exported Function | 0x0000000180011f40 | 0x00011f40
`DsListDomainsInSiteW` | 64 (0x40) | Exported Function | 0x0000000180011ed0 | 0x00011ed0
`DsListDomainsInSiteA` | 63 (0x3f) | Exported Function | 0x0000000180011e60 | 0x00011e60
`DsIsMangledRdnValueW` | 62 (0x3e) | Exported Function | DSPARSE.DsIsMangledRdnValueW | 0x000232b2
`DsRemoveDsDomainA` | 91 (0x5b) | Exported Function | 0x000000018000f6f0 | 0x0000f6f0
`DsIsMangledRdnValueA` | 61 (0x3d) | Exported Function | DSPARSE.DsIsMangledRdnValueA | 0x00023280
`DsRemoveDsDomainW` | 92 (0x5c) | Exported Function | 0x000000018000f800 | 0x0000f800
`DsRemoveDsServerW` | 94 (0x5e) | Exported Function | 0x000000018000faf0 | 0x0000faf0
`DsWriteNgcKeyA` | 123 (0x7b) | Exported Function | 0x0000000180013430 | 0x00013430
`DsWriteAccountSpnW` | 122 (0x7a) | Exported Function | 0x0000000180004070 | 0x00004070
`DsWriteAccountSpnA` | 121 (0x79) | Exported Function | 0x0000000180012d60 | 0x00012d60
`DsUnquoteRdnValueW` | 120 (0x78) | Exported Function | DSPARSE.DsUnquoteRdnValueW | 0x0002376d
`DsUnquoteRdnValueA` | 119 (0x77) | Exported Function | DSPARSE.DsUnquoteRdnValueA | 0x0002373f
`DsUnBindWWorker` | 118 (0x76) | Exported Function | 0x0000000180001f90 | 0x00001f90
`DsUnBindW` | 117 (0x75) | Exported Function | 0x0000000180001360 | 0x00001360
`DsUnBindA` | 116 (0x74) | Exported Function | 0x0000000180001360 | 0x00001360
`DsServerRegisterSpnW` | 115 (0x73) | Exported Function | 0x00000001800037e0 | 0x000037e0
`DsServerRegisterSpnA` | 114 (0x72) | Exported Function | 0x0000000180012cb0 | 0x00012cb0
`DsReplicaVerifyObjectsW` | 113 (0x71) | Exported Function | 0x00000001800117c0 | 0x000117c0
`DsReplicaVerifyObjectsA` | 112 (0x70) | Exported Function | 0x0000000180011740 | 0x00011740
`DsReplicaUpdateRefsW` | 111 (0x6f) | Exported Function | 0x0000000180011550 | 0x00011550
`DsReplicaUpdateRefsA` | 110 (0x6e) | Exported Function | 0x0000000180011480 | 0x00011480
`DsReplicaSyncW` | 109 (0x6d) | Exported Function | 0x0000000180011310 | 0x00011310
`DsReplicaSyncAllW` | 108 (0x6c) | Exported Function | 0x000000018000ed70 | 0x0000ed70
`DsReplicaSyncAllA` | 107 (0x6b) | Exported Function | 0x000000018000e6c0 | 0x0000e6c0
`DsReplicaSyncA` | 106 (0x6a) | Exported Function | 0x0000000180011290 | 0x00011290
`DsReplicaModifyW` | 105 (0x69) | Exported Function | 0x0000000180010f70 | 0x00010f70
`DsReplicaModifyA` | 104 (0x68) | Exported Function | 0x0000000180010e40 | 0x00010e40
`DsReplicaGetInfoW` | 103 (0x67) | Exported Function | 0x0000000180010e00 | 0x00010e00
`DsReplicaGetInfo2W` | 102 (0x66) | Exported Function | 0x0000000180010b30 | 0x00010b30
`DsReplicaFreeInfo` | 101 (0x65) | Exported Function | 0x0000000180010820 | 0x00010820
`DsReplicaDemotionW` | 100 (0x64) | Exported Function | 0x000000018000fc60 | 0x0000fc60
`DsReplicaDelW` | 99 (0x63) | Exported Function | 0x00000001800106a0 | 0x000106a0
`DsReplicaDelA` | 98 (0x62) | Exported Function | 0x00000001800105d0 | 0x000105d0
`DsReplicaConsistencyCheck` | 97 (0x61) | Exported Function | 0x0000000180010500 | 0x00010500
`DsReplicaAddW` | 96 (0x60) | Exported Function | 0x0000000180010100 | 0x00010100
`DsReplicaAddA` | 95 (0x5f) | Exported Function | 0x000000018000ffb0 | 0x0000ffb0
`DsRemoveDsServerA` | 93 (0x5d) | Exported Function | 0x000000018000f940 | 0x0000f940
`DsWriteNgcKeyW` | 124 (0x7c) | Exported Function | 0x0000000180013250 | 0x00013250
`DsIsMangledDnW` | 60 (0x3c) | Exported Function | DSPARSE.DsIsMangledDnW | 0x00023254
`DsInitDemotionW` | 58 (0x3a) | Exported Function | 0x000000018000f610 | 0x0000f610
`DsCrackSpn2W` | 24 (0x18) | Exported Function | DSPARSE.DsCrackSpn2W | 0x00022eac
`DsCrackSpn2A` | 23 (0x17) | Exported Function | DSPARSE.DsCrackSpn2A | 0x00022e8a
`DsCrackNamesWWorker` | 22 (0x16) | Exported Function | 0x00000001800020e0 | 0x000020e0
`DsCrackNamesW` | 21 (0x15) | Exported Function | 0x00000001800012f0 | 0x000012f0
`DsCrackNamesA` | 20 (0x14) | Exported Function | 0x0000000180008b90 | 0x00008b90
`DsClientMakeSpnForTargetServerW` | 19 (0x13) | Exported Function | 0x0000000180012750 | 0x00012750
`DsClientMakeSpnForTargetServerA` | 18 (0x12) | Exported Function | 0x00000001800125d0 | 0x000125d0
`DsBindWithSpnW` | 16 (0x10) | Exported Function | 0x0000000180007e40 | 0x00007e40
`DsBindWithSpnExWWorker` | 15 (0xf) | Exported Function | 0x00000001800013c0 | 0x000013c0
`DsBindWithSpnExW` | 14 (0xe) | Exported Function | 0x0000000180013070 | 0x00013070
`DsBindWithSpnExA` | 13 (0xd) | Exported Function | 0x0000000180008640 | 0x00008640
`DsBindWithSpnA` | 12 (0xc) | Exported Function | 0x0000000180007e10 | 0x00007e10
`DsBindWithCredW` | 11 (0xb) | Exported Function | 0x0000000180001310 | 0x00001310
`DsBindWithCredA` | 10 (0xa) | Exported Function | 0x0000000180007de0 | 0x00007de0
`DsBindW` | 9 (0x9) | Exported Function | 0x0000000180007db0 | 0x00007db0
`DsBindToISTGW` | 8 (0x8) | Exported Function | 0x00000001800081f0 | 0x000081f0
`DsBindToISTGA` | 7 (0x7) | Exported Function | 0x0000000180008160 | 0x00008160
`DsBindingSetTimeout` | 17 (0x11) | Exported Function | 0x0000000180008790 | 0x00008790
`DsBindByInstanceW` | 6 (0x6) | Exported Function | 0x00000001800013f0 | 0x000013f0
`DsBindByInstanceA` | 5 (0x5) | Exported Function | 0x0000000180007fc0 | 0x00007fc0
`DsBindA` | 4 (0x4) | Exported Function | 0x0000000180007d80 | 0x00007d80
`DsaopUnBind` | 131 (0x83) | Exported Function | 0x000000018000f420 | 0x0000f420
`DsaopPrepareScript` | 130 (0x82) | Exported Function | 0x000000018000f380 | 0x0000f380
`DsaopExecuteScript` | 129 (0x81) | Exported Function | 0x000000018000f2d0 | 0x0000f2d0
`DsaopBindWithSpn` | 128 (0x80) | Exported Function | 0x000000018000ef60 | 0x0000ef60
`DsaopBindWithCred` | 127 (0x7f) | Exported Function | 0x000000018000ef30 | 0x0000ef30
`DsaopBind` | 126 (0x7e) | Exported Function | 0x000000018000ef00 | 0x0000ef00
`DsAddSidHistoryW` | 3 (0x3) | Exported Function | 0x00000001800074a0 | 0x000074a0
`DsAddSidHistoryA` | 2 (0x2) | Exported Function | 0x0000000180007290 | 0x00007290
`DsCrackSpn3W` | 25 (0x19) | Exported Function | DSPARSE.DsCrackSpn3W | 0x00022ece
`DsIsMangledDnA` | 59 (0x3b) | Exported Function | DSPARSE.DsIsMangledDnA | 0x0002322e
`DsCrackSpn4W` | 26 (0x1a) | Exported Function | DSPARSE.DsCrackSpn4W | 0x00022ef0
`DsCrackSpnW` | 28 (0x1c) | Exported Function | DSPARSE.DsCrackSpnW | 0x00022f31
`DsInheritSecurityIdentityW` | 57 (0x39) | Exported Function | 0x0000000180007ba0 | 0x00007ba0
`DsInheritSecurityIdentityA` | 56 (0x38) | Exported Function | 0x0000000180007ab0 | 0x00007ab0
`DsGetSpnW` | 55 (0x37) | Exported Function | 0x0000000180003ae0 | 0x00003ae0
`DsGetSpnA` | 54 (0x36) | Exported Function | 0x0000000180012a30 | 0x00012a30
`DsGetRdnW` | 53 (0x35) | Exported Function | DSPARSE.DsGetRdnW | 0x000231b3
`DsGetDomainControllerInfoWWorker` | 52 (0x34) | Exported Function | 0x0000000180009aa0 | 0x00009aa0
`DsGetDomainControllerInfoW` | 51 (0x33) | Exported Function | 0x0000000180013090 | 0x00013090
`DsGetDomainControllerInfoA` | 50 (0x32) | Exported Function | 0x0000000180009810 | 0x00009810
`DsGetBindInstGuid` | 49 (0x31) | Exported Function | 0x0000000180008850 | 0x00008850
`DsGetBindAnnotW` | 48 (0x30) | Exported Function | 0x0000000180008830 | 0x00008830
`DsGetBindAddrW` | 47 (0x2f) | Exported Function | 0x0000000180008800 | 0x00008800
`DsFreeSpnArrayW` | 46 (0x2e) | Exported Function | 0x00000001800129c0 | 0x000129c0
`DsFreeSpnArrayA` | 45 (0x2d) | Exported Function | 0x00000001800129b0 | 0x000129b0
`DsFreeSchemaGuidMapW` | 44 (0x2c) | Exported Function | 0x0000000180011990 | 0x00011990
`DsFreeSchemaGuidMapA` | 43 (0x2b) | Exported Function | 0x0000000180011980 | 0x00011980
`DsFreePasswordCredentialsWorker` | 42 (0x2a) | Exported Function | 0x0000000180001250 | 0x00001250
`DsFreePasswordCredentials` | 41 (0x29) | Exported Function | 0x00000001800013a0 | 0x000013a0
`DsFreeNgcKeyWorker` | 40 (0x28) | Exported Function | 0x000000018000f480 | 0x0000f480
`DsFreeNgcKey` | 39 (0x27) | Exported Function | 0x0000000180013210 | 0x00013210
`DsFreeNameResultWWorker` | 38 (0x26) | Exported Function | 0x0000000180001e80 | 0x00001e80
`DsFreeNameResultW` | 37 (0x25) | Exported Function | 0x0000000180001340 | 0x00001340
`DsFreeNameResultA` | 36 (0x24) | Exported Function | 0x0000000180001340 | 0x00001340
`DsFreeDomainControllerInfoWWorker` | 35 (0x23) | Exported Function | 0x00000001800095f0 | 0x000095f0
`DsFreeDomainControllerInfoW` | 34 (0x22) | Exported Function | 0x00000001800095d0 | 0x000095d0
`DsFreeDomainControllerInfoA` | 33 (0x21) | Exported Function | 0x00000001800095d0 | 0x000095d0
`DsFreeCloneDcResult` | 32 (0x20) | Exported Function | 0x000000018000ff80 | 0x0000ff80
`DsFinishDemotionW` | 31 (0x1f) | Exported Function | 0x000000018000f4a0 | 0x0000f4a0
`DsCrackUnquotedMangledRdnW` | 30 (0x1e) | Exported Function | DSPARSE.DsCrackUnquotedMangledRdnW | 0x00022f9e
`DsCrackUnquotedMangledRdnA` | 29 (0x1d) | Exported Function | DSPARSE.DsCrackUnquotedMangledRdnA | 0x00022f60
`DsCrackSpnA` | 27 (0x1b) | Exported Function | DSPARSE.DsCrackSpnA | 0x00022f11
`DsWriteNgcKeyWWorker` | 125 (0x7d) | Exported Function | 0x00000001800134d0 | 0x000134d0


## Signature

* Status: Signature verified.
* Serial: `3300000266BD1580EFA75CD6D3000000000266`
* Thumbprint: `A4341B9FD50FB9964283220A36A1EF6F6FAA7840`
* Issuer: CN=Microsoft Windows Production PCA 2011, O=Microsoft Corporation, L=Redmond, S=Washington, C=US
* Subject: CN=Microsoft Windows, O=Microsoft Corporation, L=Redmond, S=Washington, C=US

## File Metadata

* Original Filename: ntdsapi.dll
* Product Name: Microsoft Windows Operating System
* Company Name: Microsoft Corporation
* File Version: 10.0.19041.1 (WinBuild.160101.0800)
* Product Version: 10.0.19041.1
* Language: English (United States)
* Legal Copyright:  Microsoft Corporation. All rights reserved.
* Machine Type: 64-bit

## File Scan

* VirusTotal Detections: 0/67
* VirusTotal Link: https://www.virustotal.com/gui/file/3c24c9eeb2bb4ca8b870910be6ea77891099e26dd12a8b07d0204e6277610974/detection/

## File Similarity (ssdeep match)

File | Score
-- | --
[C:\Windows\system32\dcdiag.exe](dcdiag.exe-7936349C0FD5FEF9317F678460C78707.md) | 33
[C:\Windows\system32\dsmgmt.exe](dsmgmt.exe-F268289F96C350F9CDA9B5AB39448E4E.md) | 38
[C:\Windows\system32\repadmin.exe](repadmin.exe-951B223D0B582BF2B5ED27EF3130F7BF.md) | 47

## Possible Misuse

*The following table contains possible examples of `ntdsapi.dll` being misused. While `ntdsapi.dll` is **not** inherently malicious, its legitimate functionality can by abused for malicious purposes.*

Source | Source File | Example | License
-- | -- | -- | --
[sigma](https://github.com/Neo23x0/sigma) | [sysmon_mimikatz_inmemory_detection.yml](https://github.com/Neo23x0/sigma/blob/master/rules/windows/image_load/sysmon_mimikatz_inmemory_detection.yml) | `- 'ntdsapi.dll'` | [DRL 1.0](https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md)



MIT License. Copyright (c) 2020 Strontic.


