---
title: duser.dll | Windows DirectUser Engine
excerpt: What is duser.dll?
---

# duser.dll 

* File Path: `C:\Windows\system32\duser.dll`
* Description: Windows DirectUser Engine

## Hashes

Type | Hash
-- | --
MD5 | `1F51AEE42369FAEE944681E55AFE065A`
SHA1 | `2ABAE1498B4B379E9E36D5737B49BCC54319A519`
SHA256 | `0A8F8EEA79D47159053D23FC154ECBB12CDE8D1EBE09908F5791073D7F3539B4`
SHA384 | `5FBE9BF7CD573DAEBFCC23B93192667C2D7F3FC2C1C39F342010C235DB99C5C6164800F226F5754F63FDE51D20913495`
SHA512 | `BACC9B214E0D0ED6B2B5FC532080F12D6981F4952CE76B1AE8C028D7A2F4905429182E84A51669D061FDEFC42B991FB2CCA169DAA2E7228D8CC3BD32374316BF`
SSDEEP | `6144:w7iRj5sXQsfcUhGkOQUV3wwXIl0AEy+DUXoDut6WFl1dXn4KVfS9ESl6GRTdoIwC:SEU69V3wwXqSwX/TFl1dX4geR7Yc`
IMP | `A58EEA7A520B65403D6A57F563000A63`
PESHA1 | `DED611B4852DC440FD8498BAD74A800C1CDE17B6`
PE256 | `7A3A702CAF04CE8534CD06E05D6A49AB76244F2AF444C57D8817755A635A984F`

## DLL Exports:

Function Name | Ordinal | Type | Address | Relative Address
-- | -- | -- | -- | --
`AddGadgetMessageHandler` | 7 (0x7) | Exported Function | 0x0000000180035f30 | 0x00035f30
`InitGadgets` | 98 (0x62) | Exported Function | 0x000000018000f1d0 | 0x0000f1d0
`InvalidateGadget` | 99 (0x63) | Exported Function | 0x00000001800020c0 | 0x000020c0
`InvalidateLayeredDescendants` | 100 (0x64) | Exported Function | 0x0000000180037e30 | 0x00037e30
`IsGadgetParentChainStyle` | 101 (0x65) | Exported Function | 0x0000000180037f40 | 0x00037f40
`IsInsideContext` | 102 (0x66) | Exported Function | 0x0000000180038050 | 0x00038050
`IsStartDelete` | 103 (0x67) | Exported Function | 0x00000001800380b0 | 0x000380b0
`InitGadgetComponent` | 97 (0x61) | Exported Function | 0x0000000180037d60 | 0x00037d60
`LookupGadgetTicket` | 104 (0x68) | Exported Function | 0x0000000180038180 | 0x00038180
`PeekMessageExA` | 106 (0x6a) | Exported Function | 0x0000000180038370 | 0x00038370
`PeekMessageExW` | 107 (0x6b) | Exported Function | 0x0000000180038440 | 0x00038440
`RegisterGadgetMessage` | 108 (0x6c) | Exported Function | 0x000000018000c720 | 0x0000c720
`RegisterGadgetMessageString` | 109 (0x6d) | Exported Function | 0x0000000180038500 | 0x00038500
`RegisterGadgetProperty` | 110 (0x6e) | Exported Function | 0x000000018000c7c0 | 0x0000c7c0
`ReleaseDetachedObjects` | 111 (0x6f) | Exported Function | 0x00000001800201b0 | 0x000201b0
`MapGadgetPoints` | 105 (0x69) | Exported Function | 0x0000000180038240 | 0x00038240
`GetStdPalette` | 96 (0x60) | Exported Function | 0x0000000180037d50 | 0x00037d50
`GetStdColorPenI` | 95 (0x5f) | Exported Function | 0x0000000180037c60 | 0x00037c60
`GetStdColorPenF` | 5 (0x5) | Exported Function | 0x0000000180035d70 | 0x00035d70
`GetGadgetRgn` | 82 (0x52) | Exported Function | 0x00000001800062b0 | 0x000062b0
`GetGadgetRootInfo` | 83 (0x53) | Exported Function | 0x0000000180037590 | 0x00037590
`GetGadgetRotation` | 84 (0x54) | Exported Function | 0x0000000180037690 | 0x00037690
`GetGadgetScale` | 85 (0x55) | Exported Function | 0x0000000180037770 | 0x00037770
`GetGadgetSize` | 86 (0x56) | Exported Function | 0x0000000180037860 | 0x00037860
`GetGadgetStyle` | 87 (0x57) | Exported Function | 0x0000000180037960 | 0x00037960
`GetGadgetTicket` | 88 (0x58) | Exported Function | 0x0000000180009880 | 0x00009880
`GetGadgetVisual` | 89 (0x59) | Exported Function | 0x0000000180020130 | 0x00020130
`GetMessageExA` | 90 (0x5a) | Exported Function | 0x000000018000d1f0 | 0x0000d1f0
`GetMessageExW` | 91 (0x5b) | Exported Function | 0x0000000180037a30 | 0x00037a30
`GetStdColorBrushF` | 3 (0x3) | Exported Function | 0x0000000180035c50 | 0x00035c50
`GetStdColorBrushI` | 92 (0x5c) | Exported Function | 0x0000000180037ae0 | 0x00037ae0
`GetStdColorF` | 4 (0x4) | Exported Function | 0x0000000180035d00 | 0x00035d00
`GetStdColorI` | 93 (0x5d) | Exported Function | 0x0000000180037bc0 | 0x00037bc0
`GetStdColorName` | 94 (0x5e) | Exported Function | 0x0000000180037c10 | 0x00037c10
`ReleaseLayeredRef` | 112 (0x70) | Exported Function | 0x0000000180038530 | 0x00038530
`ReleaseMouseCapture` | 113 (0x71) | Exported Function | 0x0000000180038610 | 0x00038610
`RemoveClippingImmunityFromVisual` | 114 (0x72) | Exported Function | 0x0000000180020200 | 0x00020200
`RemoveGadgetMessageHandler` | 115 (0x73) | Exported Function | 0x0000000180038700 | 0x00038700
`SetGadgetRotation` | 135 (0x87) | Exported Function | 0x00000001800395e0 | 0x000395e0
`SetGadgetScale` | 136 (0x88) | Exported Function | 0x0000000180039710 | 0x00039710
`SetGadgetStyle` | 137 (0x89) | Exported Function | 0x0000000180005440 | 0x00005440
`SetHardwareDeviceUsage` | 138 (0x8a) | Exported Function | 0x0000000180014cf0 | 0x00014cf0
`SetMinimumDCompVersion` | 139 (0x8b) | Exported Function | 0x00000001800202f0 | 0x000202f0
`SetRestoreCachedLayeredRefFlag` | 140 (0x8c) | Exported Function | 0x0000000180039850 | 0x00039850
`SetTransitionVisualProperties` | 141 (0x8d) | Exported Function | 0x0000000180020360 | 0x00020360
`SetWindowResizeFlag` | 142 (0x8e) | Exported Function | 0x0000000180001740 | 0x00001740
`UnregisterGadgetMessage` | 143 (0x8f) | Exported Function | 0x0000000180039910 | 0x00039910
`UnregisterGadgetMessageString` | 144 (0x90) | Exported Function | 0x0000000180038500 | 0x00038500
`UnregisterGadgetProperty` | 145 (0x91) | Exported Function | 0x00000001800399b0 | 0x000399b0
`UtilBuildFont` | 146 (0x92) | Exported Function | 0x0000000180039a50 | 0x00039a50
`UtilDrawBlendRect` | 147 (0x93) | Exported Function | 0x0000000180039a60 | 0x00039a60
`UtilDrawOutlineRect` | 6 (0x6) | Exported Function | 0x0000000180035f20 | 0x00035f20
`UtilGetColor` | 148 (0x94) | Exported Function | 0x0000000180039a70 | 0x00039a70
`SetGadgetRootInfo` | 134 (0x86) | Exported Function | 0x00000001800092d0 | 0x000092d0
`GetGadgetRect` | 81 (0x51) | Exported Function | 0x0000000180006590 | 0x00006590
`SetGadgetRect` | 133 (0x85) | Exported Function | 0x00000001800047f0 | 0x000047f0
`SetGadgetParent` | 131 (0x83) | Exported Function | 0x00000001800035f0 | 0x000035f0
`RemoveGadgetProperty` | 116 (0x74) | Exported Function | 0x0000000180038850 | 0x00038850
`ResetDUserDevice` | 117 (0x75) | Exported Function | 0x0000000180038970 | 0x00038970
`ScheduleGadgetTransitions` | 118 (0x76) | Exported Function | 0x0000000180020260 | 0x00020260
`SetActionTimeslice` | 119 (0x77) | Exported Function | 0x0000000180038a80 | 0x00038a80
`SetAtlasingHints` | 120 (0x78) | Exported Function | 0x0000000180038b30 | 0x00038b30
`SetGadgetBufferInfo` | 121 (0x79) | Exported Function | 0x0000000180038c40 | 0x00038c40
`SetGadgetCenterPoint` | 122 (0x7a) | Exported Function | 0x0000000180038d80 | 0x00038d80
`SetGadgetFillF` | 123 (0x7b) | Exported Function | 0x0000000180038ec0 | 0x00038ec0
`SetGadgetFillI` | 124 (0x7c) | Exported Function | 0x0000000180038fe0 | 0x00038fe0
`SetGadgetFlags` | 125 (0x7d) | Exported Function | 0x0000000180039130 | 0x00039130
`SetGadgetFocus` | 126 (0x7e) | Exported Function | 0x00000001800095c0 | 0x000095c0
`SetGadgetFocusEx` | 127 (0x7f) | Exported Function | 0x0000000180039280 | 0x00039280
`SetGadgetLayerInfo` | 128 (0x80) | Exported Function | 0x00000001800393a0 | 0x000393a0
`SetGadgetMessageFilter` | 129 (0x81) | Exported Function | 0x000000018000d840 | 0x0000d840
`SetGadgetOrder` | 130 (0x82) | Exported Function | 0x0000000180014000 | 0x00014000
`SetGadgetProperty` | 132 (0x84) | Exported Function | 0x00000001800394b0 | 0x000394b0
`GetGadgetProperty` | 80 (0x50) | Exported Function | 0x0000000180011150 | 0x00011150
`GetGadgetMessageFilter` | 79 (0x4f) | Exported Function | 0x00000001800374c0 | 0x000374c0
`GetGadgetLayerInfo` | 78 (0x4e) | Exported Function | 0x00000001800373b0 | 0x000373b0
`DetachGadgetVisuals` | 48 (0x30) | Exported Function | 0x000000018001fe60 | 0x0001fe60
`DetachWndProc` | 49 (0x31) | Exported Function | 0x0000000180013590 | 0x00013590
`DisableContainerHwnd` | 50 (0x32) | Exported Function | 0x0000000180014ae0 | 0x00014ae0
`DllMain` | 51 (0x33) | Exported Function | 0x0000000180016090 | 0x00016090
`DrawGadgetTree` | 52 (0x34) | Exported Function | 0x0000000180036780 | 0x00036780
`DUserBuildGadget` | 25 (0x19) | Exported Function | 0x0000000180036390 | 0x00036390
`DUserCastClass` | 26 (0x1a) | Exported Function | 0x0000000180036400 | 0x00036400
`DUserCastDirect` | 27 (0x1b) | Exported Function | 0x0000000180036490 | 0x00036490
`DUserCastHandle` | 1 (0x1) | Exported Function | 0x0000000180035890 | 0x00035890
`DUserDeleteGadget` | 2 (0x2) | Exported Function | 0x00000001800358b0 | 0x000358b0
`DUserFindClass` | 28 (0x1c) | Exported Function | 0x00000001800364d0 | 0x000364d0
`DUserFlushDeferredMessages` | 29 (0x1d) | Exported Function | 0x0000000180014730 | 0x00014730
`DUserFlushMessages` | 30 (0x1e) | Exported Function | 0x00000001800115d0 | 0x000115d0
`DUserGetAlphaPRID` | 31 (0x1f) | Exported Function | 0x0000000180020ff0 | 0x00020ff0
`DUserGetGutsData` | 32 (0x20) | Exported Function | 0x0000000180036530 | 0x00036530
`DestroyPendingDCVisuals` | 47 (0x2f) | Exported Function | 0x000000018001fe30 | 0x0001fe30
`DUserGetRectPRID` | 33 (0x21) | Exported Function | 0x0000000180021000 | 0x00021000
`DeleteHandle` | 46 (0x2e) | Exported Function | 0x000000018000ff60 | 0x0000ff60
`CreateGadget` | 23 (0x17) | Exported Function | 0x0000000180006fe0 | 0x00006fe0
`AddLayeredRef` | 8 (0x8) | Exported Function | 0x0000000180036080 | 0x00036080
`AdjustClipInsideRef` | 9 (0x9) | Exported Function | 0x0000000180036160 | 0x00036160
`AttachWndProcA` | 10 (0xa) | Exported Function | 0x0000000180036240 | 0x00036240
`AttachWndProcW` | 11 (0xb) | Exported Function | 0x000000018000f3d0 | 0x0000f3d0
`AutoTrace` | 12 (0xc) | Exported Function | 0x0000000180017480 | 0x00017480
`BeginHideInputPaneAnimation` | 13 (0xd) | Exported Function | 0x000000018001fa00 | 0x0001fa00
`BeginShowInputPaneAnimation` | 14 (0xe) | Exported Function | 0x000000018001fa40 | 0x0001fa40
`BuildAnimation` | 15 (0xf) | Exported Function | 0x000000018001fa80 | 0x0001fa80
`BuildDropTarget` | 16 (0x10) | Exported Function | 0x000000018001fb10 | 0x0001fb10
`BuildInterpolation` | 17 (0x11) | Exported Function | 0x000000018001fb90 | 0x0001fb90
`CacheDWriteRenderTarget` | 18 (0x12) | Exported Function | 0x000000018001fc20 | 0x0001fc20
`ChangeCurrentAnimationScenario` | 19 (0x13) | Exported Function | 0x000000018001fc80 | 0x0001fc80
`ClearPushedOpacitiesFromGadgetTree` | 20 (0x14) | Exported Function | 0x0000000180036280 | 0x00036280
`ClearTopmostVisual` | 21 (0x15) | Exported Function | 0x000000018001fce0 | 0x0001fce0
`CreateAction` | 22 (0x16) | Exported Function | 0x00000001800110b0 | 0x000110b0
`CustomGadgetHitTestQuery` | 24 (0x18) | Exported Function | 0x000000018001fd20 | 0x0001fd20
`UtilSetBackground` | 149 (0x95) | Exported Function | 0x0000000180039a80 | 0x00039a80
`DUserGetRotatePRID` | 34 (0x22) | Exported Function | 0x0000000180021010 | 0x00021010
`DUserInstanceOf` | 36 (0x24) | Exported Function | 0x00000001800365c0 | 0x000365c0
`FreeGdiDxInteropStagingBuffer` | 63 (0x3f) | Exported Function | 0x0000000180036d00 | 0x00036d00
`GadgetTransCompositionChanged` | 64 (0x40) | Exported Function | 0x0000000180036dd0 | 0x00036dd0
`GadgetTransSettingChanged` | 65 (0x41) | Exported Function | 0x000000018001ffd0 | 0x0001ffd0
`GetActionTimeslice` | 66 (0x42) | Exported Function | 0x0000000180036ee0 | 0x00036ee0
`GetCachedDWriteRenderTarget` | 67 (0x43) | Exported Function | 0x0000000180020020 | 0x00020020
`GetDebug` | 69 (0x45) | Exported Function | 0x00000001800174b0 | 0x000174b0
`GetDUserModule` | 68 (0x44) | Exported Function | 0x0000000180036f90 | 0x00036f90
`GetFinalAnimatingPosition` | 70 (0x46) | Exported Function | 0x00000001800200b0 | 0x000200b0
`GetGadget` | 71 (0x47) | Exported Function | 0x0000000180036fa0 | 0x00036fa0
`GetGadgetAnimation` | 72 (0x48) | Exported Function | 0x00000001800147b0 | 0x000147b0
`GetGadgetBitmap` | 73 (0x49) | Exported Function | 0x0000000180037080 | 0x00037080
`GetGadgetBufferInfo` | 74 (0x4a) | Exported Function | 0x00000001800371b0 | 0x000371b0
`GetGadgetCenterPoint` | 75 (0x4b) | Exported Function | 0x00000001800372c0 | 0x000372c0
`GetGadgetFlags` | 76 (0x4c) | Exported Function | 0x000000018000e150 | 0x0000e150
`GetGadgetFocus` | 77 (0x4d) | Exported Function | 0x0000000180009700 | 0x00009700
`ForwardGadgetMessage` | 62 (0x3e) | Exported Function | 0x0000000180009c80 | 0x00009c80
`DUserGetScalePRID` | 35 (0x23) | Exported Function | 0x0000000180021020 | 0x00021020
`FireGadgetMessages` | 61 (0x3d) | Exported Function | 0x0000000180036c00 | 0x00036c00
`FindGadgetTargetingInfo` | 59 (0x3b) | Exported Function | 0x0000000180036af0 | 0x00036af0
`DUserPostEvent` | 37 (0x25) | Exported Function | 0x0000000180010a70 | 0x00010a70
`DUserPostMethod` | 38 (0x26) | Exported Function | 0x0000000180036630 | 0x00036630
`DUserRegisterGuts` | 39 (0x27) | Exported Function | 0x0000000180007ae0 | 0x00007ae0
`DUserRegisterStub` | 40 (0x28) | Exported Function | 0x0000000180007810 | 0x00007810
`DUserRegisterSuper` | 41 (0x29) | Exported Function | 0x0000000180008d90 | 0x00008d90
`DUserSendEvent` | 42 (0x2a) | Exported Function | 0x000000018000db30 | 0x0000db30
`DUserSendMethod` | 43 (0x2b) | Exported Function | 0x00000001800366d0 | 0x000366d0
`DUserStopAnimation` | 44 (0x2c) | Exported Function | 0x00000001800215b0 | 0x000215b0
`DUserStopPVLAnimation` | 45 (0x2d) | Exported Function | 0x000000018001fdc0 | 0x0001fdc0
`EndInputPaneAnimation` | 53 (0x35) | Exported Function | 0x000000018001ff00 | 0x0001ff00
`EnsureAnimationsEnabled` | 54 (0x36) | Exported Function | 0x000000018001ff40 | 0x0001ff40
`EnsureGadgetTransInitialized` | 55 (0x37) | Exported Function | 0x000000018001ff90 | 0x0001ff90
`EnumGadgets` | 56 (0x38) | Exported Function | 0x00000001800368b0 | 0x000368b0
`FindGadgetFromPoint` | 57 (0x39) | Exported Function | 0x0000000180010290 | 0x00010290
`FindGadgetMessages` | 58 (0x3a) | Exported Function | 0x0000000180036a10 | 0x00036a10
`FindStdColor` | 60 (0x3c) | Exported Function | 0x000000018000e0d0 | 0x0000e0d0
`WaitMessageEx` | 150 (0x96) | Exported Function | 0x0000000180039ae0 | 0x00039ae0


## Signature

* Status: Signature verified.
* Serial: `3300000266BD1580EFA75CD6D3000000000266`
* Thumbprint: `A4341B9FD50FB9964283220A36A1EF6F6FAA7840`
* Issuer: CN=Microsoft Windows Production PCA 2011, O=Microsoft Corporation, L=Redmond, S=Washington, C=US
* Subject: CN=Microsoft Windows, O=Microsoft Corporation, L=Redmond, S=Washington, C=US

## File Metadata

* Original Filename: DUser.DLL.MUI
* Product Name: Microsoft Windows Operating System
* Company Name: Microsoft Corporation
* File Version: 10.0.19041.1 (WinBuild.160101.0800)
* Product Version: 10.0.19041.1
* Language: English (United States)
* Legal Copyright:  Microsoft Corporation. All rights reserved.
* Machine Type: 64-bit

## File Scan

* VirusTotal Detections: 0/69
* VirusTotal Link: https://www.virustotal.com/gui/file/0a8f8eea79d47159053d23fc154ecbb12cde8d1ebe09908f5791073d7f3539b4/detection/


## Possible Misuse

*The following table contains possible examples of `duser.dll` being misused. While `duser.dll` is **not** inherently malicious, its legitimate functionality can by abused for malicious purposes.*

Source | Source File | Example | License
-- | -- | -- | --
[signature-base](https://github.com/Neo23x0/signature-base) | [apt_sidewinder.yar](https://github.com/Neo23x0/signature-base/blob/master/yara/apt_sidewinder.yar) | $a1 = "DUSER.dll" fullword wide | [CC BY-NC 4.0](https://github.com/Neo23x0/signature-base/blob/master/LICENSE)



MIT License. Copyright (c) 2020 Strontic.


