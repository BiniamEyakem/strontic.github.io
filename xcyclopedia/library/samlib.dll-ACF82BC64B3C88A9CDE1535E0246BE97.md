---
title: samlib.dll | SAM Library DLL
excerpt: What is samlib.dll?
---

# samlib.dll 

* File Path: `C:\Windows\system32\samlib.dll`
* Description: SAM Library DLL

## Hashes

Type | Hash
-- | --
MD5 | `ACF82BC64B3C88A9CDE1535E0246BE97`
SHA1 | `E84FCC47BD61ADE4B7581B03CC97BA44D169318E`
SHA256 | `3A0E45C9509ADB0A0102709BD73A524CB4B3E3B7543BB0FB569461E56776CD6F`
SHA384 | `016031329C3A3F4A8CD34EFC84D80863F33643AF3CA3E8653325FD3E6687CA8D77BEA540C58420215913DABA3E82425B`
SHA512 | `4E5525A0BD421FEB296F1CCC3855B2F714A2BBDC4A8CF90144AD37F4F8533BBA5D45C105DC553C1FB4F7A30A026195149D0A755183EA78CC25FD489CB691EBD0`
SSDEEP | `3072:YCEy4YnD9/DIlBVLRtec1ATUwTN+AqI7Z90afbD:YCzvDelf9Qc1ATUwhd7Nf`
IMP | `DDE5FA77DD46F9C604832FB40207DECC`
PESHA1 | `14495CC442D7F0442A387664D280A8131D150B92`
PE256 | `DAA8E99698ED1C4F8B70611A7F62150F90CBB649189D76DE1686C67069B947EA`

## DLL Exports:

Function Name | Ordinal | Type | Address | Relative Address
-- | -- | -- | -- | --
`OnMachineUILanguageInit` | 1 (0x1) | Exported Function | 0x00000001800080e0 | 0x000080e0
`SamLookupDomainInSamServer` | 29 (0x1d) | Exported Function | 0x00000001800018d0 | 0x000018d0
`SamLookupIdsInDomain` | 30 (0x1e) | Exported Function | 0x0000000180001fb0 | 0x00001fb0
`SamLookupNamesInDomain` | 31 (0x1f) | Exported Function | 0x0000000180001b50 | 0x00001b50
`SamLookupNamesInDomain2` | 32 (0x20) | Exported Function | 0x0000000180002260 | 0x00002260
`SamOpenAlias` | 33 (0x21) | Exported Function | 0x00000001800036c0 | 0x000036c0
`SamOpenDomain` | 34 (0x22) | Exported Function | 0x0000000180002d60 | 0x00002d60
`SamOpenGroup` | 35 (0x23) | Exported Function | 0x000000018000ad00 | 0x0000ad00
`SamOpenUser` | 36 (0x24) | Exported Function | 0x00000001800027c0 | 0x000027c0
`SamPerformGenericOperation` | 37 (0x25) | Exported Function | 0x0000000180001430 | 0x00001430
`SamQueryDisplayInformation` | 38 (0x26) | Exported Function | 0x000000018000af20 | 0x0000af20
`SamQueryInformationAlias` | 39 (0x27) | Exported Function | 0x000000018000b240 | 0x0000b240
`SamQueryInformationDomain` | 40 (0x28) | Exported Function | 0x0000000180010dd0 | 0x00010dd0
`SamQueryInformationGroup` | 41 (0x29) | Exported Function | 0x000000018000b3f0 | 0x0000b3f0
`SamQueryInformationUser` | 42 (0x2a) | Exported Function | 0x00000001800029b0 | 0x000029b0
`SamQueryLocalizableAccountsInDomain` | 43 (0x2b) | Exported Function | 0x000000018000b6b0 | 0x0000b6b0
`SamQuerySecurityObject` | 44 (0x2c) | Exported Function | 0x00000001800015c0 | 0x000015c0
`SamRegisterObjectChangeNotification` | 45 (0x2d) | Exported Function | 0x0000000180001350 | 0x00001350
`SamTestPrivateFunctionsUser` | 59 (0x3b) | Exported Function | 0x000000018000d2f0 | 0x0000d2f0
`SamTestPrivateFunctionsDomain` | 58 (0x3a) | Exported Function | 0x000000018000d2b0 | 0x0000d2b0
`SamShutdownSamServer` | 57 (0x39) | Exported Function | 0x000000018000d220 | 0x0000d220
`SamSetSecurityObject` | 56 (0x38) | Exported Function | 0x000000018000cfb0 | 0x0000cfb0
`SamSetMemberAttributesOfGroup` | 55 (0x37) | Exported Function | 0x000000018000ce00 | 0x0000ce00
`SamSetInformationUser` | 54 (0x36) | Exported Function | 0x000000018000c440 | 0x0000c440
`SamiSyncDSRMPasswordFromAccount` | 70 (0x46) | Exported Function | 0x000000018000e810 | 0x0000e810
`SamSetInformationGroup` | 53 (0x35) | Exported Function | 0x000000018000c290 | 0x0000c290
`SamSetInformationAlias` | 51 (0x33) | Exported Function | 0x000000018000bf30 | 0x0000bf30
`SamRidToSid` | 50 (0x32) | Exported Function | 0x00000001800022f0 | 0x000022f0
`SamRemoveMultipleMembersFromAlias` | 49 (0x31) | Exported Function | 0x000000018000bd60 | 0x0000bd60
`SamRemoveMemberFromGroup` | 48 (0x30) | Exported Function | 0x000000018000bbc0 | 0x0000bbc0
`SamRemoveMemberFromForeignDomain` | 47 (0x2f) | Exported Function | 0x000000018000ba30 | 0x0000ba30
`SamRemoveMemberFromAlias` | 46 (0x2e) | Exported Function | 0x000000018000b8a0 | 0x0000b8a0
`SamSetInformationDomain` | 52 (0x34) | Exported Function | 0x000000018000c0e0 | 0x0000c0e0
`SamiSetDSRMPasswordOWF` | 69 (0x45) | Exported Function | 0x000000018000e7a0 | 0x0000e7a0
`SamiSetDSRMPassword` | 68 (0x44) | Exported Function | 0x000000018000e730 | 0x0000e730
`SamiSetBootKeyInformation` | 67 (0x43) | Exported Function | 0x000000018000e570 | 0x0000e570
`SamDeleteGroup` | 15 (0xf) | Exported Function | 0x000000018000a170 | 0x0000a170
`SamDeleteAlias` | 14 (0xe) | Exported Function | 0x0000000180009fd0 | 0x00009fd0
`SamCreateUserInDomain` | 13 (0xd) | Exported Function | 0x0000000180009da0 | 0x00009da0
`SamCreateUser2InDomain` | 12 (0xc) | Exported Function | 0x0000000180009990 | 0x00009990
`SamCreateGroupInDomain` | 11 (0xb) | Exported Function | 0x0000000180009750 | 0x00009750
`SamCreateAliasInDomain` | 10 (0xa) | Exported Function | 0x0000000180009510 | 0x00009510
`SamDeleteUser` | 16 (0x10) | Exported Function | 0x000000018000a310 | 0x0000a310
`SamConnectWithCreds` | 9 (0x9) | Exported Function | 0x0000000180010bd0 | 0x00010bd0
`SamCloseHandle` | 7 (0x7) | Exported Function | 0x0000000180002fb0 | 0x00002fb0
`SamChangePasswordUser2` | 6 (0x6) | Exported Function | 0x0000000180009310 | 0x00009310
`SamChangePasswordUser` | 5 (0x5) | Exported Function | 0x0000000180008ff0 | 0x00008ff0
`SamAddMultipleMembersToAlias` | 4 (0x4) | Exported Function | 0x0000000180008e20 | 0x00008e20
`SamAddMemberToGroup` | 3 (0x3) | Exported Function | 0x0000000180008c70 | 0x00008c70
`SamAddMemberToAlias` | 2 (0x2) | Exported Function | 0x0000000180003910 | 0x00003910
`SamConnect` | 8 (0x8) | Exported Function | 0x0000000180002ab0 | 0x00002ab0
`SamUnregisterObjectChangeNotification` | 60 (0x3c) | Exported Function | 0x00000001800012f0 | 0x000012f0
`SamEnumerateAliasesInDomain` | 17 (0x11) | Exported Function | 0x000000018000a4b0 | 0x0000a4b0
`SamEnumerateGroupsInDomain` | 19 (0x13) | Exported Function | 0x000000018000a6d0 | 0x0000a6d0
`SamiLmChangePasswordUser` | 66 (0x42) | Exported Function | 0x000000018000e360 | 0x0000e360
`SamiEncryptPasswords` | 65 (0x41) | Exported Function | 0x0000000180007d80 | 0x00007d80
`SamiChangePasswordUser2` | 64 (0x40) | Exported Function | 0x000000018000df20 | 0x0000df20
`SamiChangePasswordUser` | 63 (0x3f) | Exported Function | 0x000000018000da20 | 0x0000da20
`SamiChangeKeys` | 62 (0x3e) | Exported Function | 0x000000018000d5d0 | 0x0000d5d0
`SamGetMembersInGroup` | 28 (0x1c) | Exported Function | 0x000000018000aae0 | 0x0000aae0
`SamEnumerateDomainsInSamServer` | 18 (0x12) | Exported Function | 0x00000001800019e0 | 0x000019e0
`SamGetMembersInAlias` | 27 (0x1b) | Exported Function | 0x0000000180003590 | 0x00003590
`SamGetDisplayEnumerationIndex` | 25 (0x19) | Exported Function | 0x000000018000a8f0 | 0x0000a8f0
`SamGetCompatibilityMode` | 24 (0x18) | Exported Function | 0x0000000180001260 | 0x00001260
`SamGetAliasMembership` | 23 (0x17) | Exported Function | 0x0000000180001e00 | 0x00001e00
`SamFreeMemory` | 22 (0x16) | Exported Function | 0x0000000180001010 | 0x00001010
`SamEnumerateUsersInDomain2` | 21 (0x15) | Exported Function | 0x0000000180001830 | 0x00001830
`SamEnumerateUsersInDomain` | 20 (0x14) | Exported Function | 0x0000000180001520 | 0x00001520
`SamGetGroupsForUser` | 26 (0x1a) | Exported Function | 0x00000001800016e0 | 0x000016e0
`SamValidatePassword` | 61 (0x3d) | Exported Function | 0x000000018000d330 | 0x0000d330


## Signature

* Status: Signature verified.
* Serial: `3300000266BD1580EFA75CD6D3000000000266`
* Thumbprint: `A4341B9FD50FB9964283220A36A1EF6F6FAA7840`
* Issuer: CN=Microsoft Windows Production PCA 2011, O=Microsoft Corporation, L=Redmond, S=Washington, C=US
* Subject: CN=Microsoft Windows, O=Microsoft Corporation, L=Redmond, S=Washington, C=US

## File Metadata

* Original Filename: SAMLib.DLL
* Product Name: Microsoft Windows Operating System
* Company Name: Microsoft Corporation
* File Version: 10.0.19041.488 (WinBuild.160101.0800)
* Product Version: 10.0.19041.488
* Language: English (United States)
* Legal Copyright:  Microsoft Corporation. All rights reserved.
* Machine Type: 64-bit

## File Scan

* VirusTotal Detections: 0/68
* VirusTotal Link: https://www.virustotal.com/gui/file/3a0e45c9509adb0a0102709bd73a524cb4b3e3b7543bb0fb569461e56776cd6f/detection/


## Possible Misuse

*The following table contains possible examples of `samlib.dll` being misused. While `samlib.dll` is **not** inherently malicious, its legitimate functionality can by abused for malicious purposes.*

Source | Source File | Example | License
-- | -- | -- | --
[sigma](https://github.com/Neo23x0/sigma) | [sysmon_mimikatz_inmemory_detection.yml](https://github.com/Neo23x0/sigma/blob/master/rules/windows/image_load/sysmon_mimikatz_inmemory_detection.yml) | `- 'samlib.dll'` | [DRL 1.0](https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md)
[sigma](https://github.com/Neo23x0/sigma) | [sysmon_susp_image_load.yml](https://github.com/Neo23x0/sigma/blob/master/rules/windows/image_load/sysmon_susp_image_load.yml) | `description: Detects Loading of samlib.dll, WinSCard.dll from untypical process e.g. through process hollowing by Mimikatz` | [DRL 1.0](https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md)
[sigma](https://github.com/Neo23x0/sigma) | [sysmon_susp_image_load.yml](https://github.com/Neo23x0/sigma/blob/master/rules/windows/image_load/sysmon_susp_image_load.yml) | `- '*\samlib.dll'` | [DRL 1.0](https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md)



MIT License. Copyright (c) 2020 Strontic.


